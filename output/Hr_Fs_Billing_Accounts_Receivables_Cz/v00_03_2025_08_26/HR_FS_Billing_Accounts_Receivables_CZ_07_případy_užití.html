<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P≈ô√≠pady u≈æit√≠ - Hr Fs Billing Accounts Receivables Cz</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        :root {
            --pico-font-size: 16px;
            --pico-line-height: 1.5;
        }

        /* Layout Structure */
        body {
            margin: 0;
            padding: 0;
            padding-top: 60px; /* Space for floating header */
        }

        /* Floating Top Bar */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: var(--pico-background-color);
            border-bottom: 1px solid var(--pico-muted-border-color);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 1rem;
            gap: 1rem;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .top-bar.hidden {
            transform: translateY(-100%);
        }

        .top-bar .nav-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .top-bar .nav-buttons button {
            margin: 0;
            padding: 0.5rem 1rem;
        }

        .top-bar .title {
            flex: 1;
            font-weight: 600;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .top-bar .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .top-bar .controls label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0;
            white-space: nowrap;
        }

        .top-bar .controls select,
        .top-bar .controls input[type="checkbox"] {
            margin: 0;
        }

        /* Main Layout */
        .layout {
            display: flex;
            min-height: calc(100vh - 60px);
        }

        /* Left Sidebar - Modern 2025 Design */
        .sidebar {
            width: 280px;
            background: var(--pico-background-color);
            border-right: 1px solid var(--pico-muted-border-color);
            height: calc(100vh - 60px);
            position: sticky;
            top: 60px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Search Section */
        .sidebar-search {
            padding: 1rem;
            border-bottom: 1px solid var(--pico-muted-border-color);
            background: var(--pico-card-background-color);
        }

        .sidebar-search input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--pico-border-radius);
            background: var(--pico-background-color);
            color: var(--pico-color);
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }

        .sidebar-search input:focus {
            outline: none;
            border-color: var(--pico-primary);
            box-shadow: 0 0 0 2px var(--pico-primary-background);
        }

        .sidebar-search input::placeholder {
            color: var(--pico-muted-color);
        }

        /* Navigation Header */
        .sidebar-header {
            padding: 1rem 1rem 0.5rem;
            background: var(--pico-card-background-color);
        }

        .sidebar-header h4 {
            margin: 0;
            color: var(--pico-color);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Scrollable Navigation Area */
        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem 1rem 1rem;
            background: var(--pico-card-background-color);
        }

        .sidebar nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar nav li {
            margin: 0;
        }

        /* Modern Tree Navigation Item */
        .nav-item {
            margin: 2px 0;
            border-radius: var(--pico-border-radius);
            overflow: hidden;
        }

        .nav-item-header {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 0;
            margin: 0;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: var(--pico-border-radius);
            transition: all 0.2s ease;
        }

        .nav-item-header:hover {
            background: var(--pico-secondary-background);
        }

        .nav-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            margin-right: 0.5rem;
            color: var(--pico-muted-color);
            font-size: 12px;
            border-radius: 3px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .nav-toggle:hover {
            background: var(--pico-muted-border-color);
            color: var(--pico-color);
        }

        .nav-toggle.expanded {
            transform: rotate(90deg);
        }

        .nav-link {
            flex: 1;
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem 0.5rem 0;
            text-decoration: none;
            color: var(--pico-color);
            font-size: 0.875rem;
            line-height: 1.4;
            border-radius: var(--pico-border-radius);
            transition: all 0.2s ease;
            min-height: 32px;
        }

        .nav-link:hover {
            color: var(--pico-primary);
            text-decoration: none;
        }

        .nav-link.active {
            color: var(--pico-primary);
            font-weight: 500;
            background: var(--pico-primary-background);
        }

        /* Hierarchy Levels */
        .nav-link.h1 {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .nav-link.h2 {
            font-size: 0.85rem;
            margin-left: 1.5rem;
            color: var(--pico-muted-color);
        }

        .nav-link.h3 {
            font-size: 0.8rem;
            margin-left: 2.5rem;
            color: var(--pico-muted-color);
        }

        /* Children Container */
        .nav-children {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            margin-left: 24px;
        }

        .nav-children.expanded {
            max-height: 1000px;
        }

        /* No Results State */
        .nav-no-results {
            padding: 1rem;
            text-align: center;
            color: var(--pico-muted-color);
            font-size: 0.875rem;
            font-style: italic;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
            max-width: none;
            transition: max-width 0.3s ease;
        }

        .main-content.narrow { max-width: 800px; margin: 0 auto; }
        .main-content.wide { max-width: 1400px; margin: 0 auto; }
        .main-content.standard { max-width: 1200px; margin: 0 auto; }

        /* Right Sidebar - Modern Minimap */
        .minimap {
            width: 80px;
            background: var(--pico-card-background-color);
            border-left: 1px solid var(--pico-muted-border-color);
            height: calc(100vh - 60px);
            position: sticky;
            top: 60px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .minimap-header {
            padding: 0.75rem 0.5rem;
            border-bottom: 1px solid var(--pico-muted-border-color);
            background: var(--pico-background-color);
        }

        .minimap h4 {
            font-size: 0.7rem;
            margin: 0;
            text-align: center;
            color: var(--pico-muted-color);
            font-weight: 500;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .minimap-content {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: var(--pico-background-color);
        }

        .minimap-viewport {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 123, 255, 0.1);
            border: 1px solid rgba(0, 123, 255, 0.3);
            border-radius: 2px;
            min-height: 20px;
            transition: all 0.1s ease;
        }

        [data-theme="dark"] .minimap-viewport {
            background: rgba(100, 200, 255, 0.15);
            border-color: rgba(100, 200, 255, 0.4);
        }

        /* Change Indicator Bar - Integrated with Minimap */
        .change-indicator {
            position: absolute;
            top: 0;
            left: 4px;
            right: 4px;
            bottom: 0;
            pointer-events: none;
            z-index: 10;
        }

        .change-mark {
            position: absolute;
            left: 0;
            right: 0;
            height: 3px;
            border-radius: 1.5px;
            cursor: pointer;
            transition: all 0.2s ease;
            pointer-events: all;
        }

        .change-mark.added {
            background: #22c55e;
            box-shadow: 0 0 4px rgba(34, 197, 94, 0.4);
        }

        .change-mark.modified {
            background: #f59e0b;
            box-shadow: 0 0 4px rgba(245, 158, 11, 0.4);
        }

        .change-mark.removed {
            background: #ef4444;
            box-shadow: 0 0 4px rgba(239, 68, 68, 0.4);
        }

        .change-mark:hover {
            height: 5px;
            box-shadow: 0 0 8px currentColor;
        }

        /* Modern Line-by-Line Diff Highlighting */
        .diff-line-added {
            background: rgba(34, 197, 94, 0.15) !important;
            border-left: 3px solid #22c55e;
            padding-left: 1rem !important;
            margin: 2px 0;
        }

        .diff-line-removed {
            background: rgba(239, 68, 68, 0.15) !important;
            border-left: 3px solid #ef4444;
            padding-left: 1rem !important;
            margin: 2px 0;
            text-decoration: line-through;
            opacity: 0.8;
        }

        .diff-line-modified {
            background: rgba(245, 158, 11, 0.15) !important;
            border-left: 3px solid #f59e0b;
            padding-left: 1rem !important;
            margin: 2px 0;
        }

        /* Dark theme adjustments */
        [data-theme="dark"] .diff-line-added {
            background: rgba(34, 197, 94, 0.2) !important;
        }

        [data-theme="dark"] .diff-line-removed {
            background: rgba(239, 68, 68, 0.2) !important;
        }

        [data-theme="dark"] .diff-line-modified {
            background: rgba(245, 158, 11, 0.2) !important;
        }

        /* Enhanced Table Styling */
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 2rem 0;
            background: var(--pico-card-background-color);
            border-radius: var(--pico-border-radius);
            overflow: hidden;
            box-shadow: var(--pico-card-box-shadow);
        }

        table th, table td { 
            border: 1px solid var(--pico-muted-border-color);
            padding: 0.75rem;
            text-align: left;
            vertical-align: top;
        }

        table td {
            background-color: var(--pico-card-background-color);
        }

        table th { 
            background: var(--pico-contrast);
            color: var(--pico-contrast-inverse);
            font-weight: 600;
            border-bottom: 2px solid var(--pico-muted-border-color);
            position: relative;
        }

        /* High contrast table headers for both themes */
        [data-theme="dark"] table th {
            background: #2a2a2a;
            color: #ffffff;
            border-color: #404040;
        }

        [data-theme="light"] table th {
            background: #f8f9fa;
            color: #212529;
            border-color: #dee2e6;
        }

        table caption { 
            caption-side: top; 
            padding: 1rem; 
            font-weight: 600; 
            text-align: left;
            color: var(--pico-muted-color);
        }

        /* Diff Styling - Light and Dark Mode Aware */
        .diff-added { 
            background: var(--pico-ins-color) !important; 
            color: var(--pico-contrast-color); 
            border: 2px solid #28a745 !important;
        }

        .diff-removed { 
            background: var(--pico-del-color) !important; 
            color: var(--pico-contrast-color); 
            text-decoration: line-through; 
            border: 2px solid #dc3545 !important;
        }

        .diff-modified {
            background: var(--pico-mark-background-color) !important;
            color: var(--pico-mark-color) !important;
            border: 2px solid #ffc107 !important;
        }

        /* Custom theme-aware variables */
        :root {
            --diff-added-bg: #d4f6d4;
            --diff-added-color: #0d5016;
            --diff-removed-bg: #f8d7da;
            --diff-removed-color: #721c24;
            --diff-modified-bg: #fff3cd;
            --diff-modified-color: #856404;
        }

        [data-theme="dark"] {
            --diff-added-bg: #1a3d1a;
            --diff-added-color: #90ee90;
            --diff-removed-bg: #3d1a1a;
            --diff-removed-color: #ffb3b3;
            --diff-modified-bg: #3d3d1a;
            --diff-modified-color: #ffeb99;
        }

        .diff-added { 
            background: var(--diff-added-bg) !important; 
            color: var(--diff-added-color) !important; 
            border: 2px solid #28a745 !important;
        }

        .diff-removed { 
            background: var(--diff-removed-bg) !important; 
            color: var(--diff-removed-color) !important; 
            text-decoration: line-through; 
            border: 2px solid #dc3545 !important;
        }

        .diff-modified {
            background: var(--diff-modified-bg) !important;
            color: var(--diff-modified-color) !important;
            border: 2px solid #ffc107 !important;
        }

        /* Improved dark mode colors */
        [data-theme="dark"] {
            --pico-muted-color: #b3b3b3;
            --pico-color: #e0e0e0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .top-bar .title {
                font-size: 0.9rem;
            }
            
            .top-bar .controls {
                gap: 0.5rem;
            }
            
            .top-bar .controls label {
                font-size: 0.8rem;
            }
            
            .change-indicator {
                right: 10px;
                width: 8px;
            }
        }

        /* Dark mode enhancements */
        @media (prefers-color-scheme: dark) {
            .change-indicator {
                background: rgba(255,255,255,0.1);
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/diff@5.1.0/dist/diff.min.js"></script>
</head>
<body>
    <!-- Floating Top Bar -->
    <header class="top-bar" id="topBar">
        <div class="nav-buttons">
            <button onclick="goBack()">‚Üê Back</button>
            <button onclick="goToIndex()">üìã Index</button>
        </div>
        
        <h1 class="title">Hr Fs Billing Accounts Receivables Cz - P≈ô√≠pady u≈æit√≠</h1>
        
        <div class="controls">
            <label>
                <input type="checkbox" id="showChanges" onchange="toggleDiff()" role="switch">
                Show changes
            </label>
            
            <label>
                Version:
                <select id="versionSelect" onchange="loadVersionForComparison()">
                    
                </select>
            </label>
            
            <label>
                Width:
                <select id="widthSelect" onchange="changeWidth()">
                    <option value="standard">Standard</option>
                    <option value="narrow">Narrow</option>
                    <option value="wide">Wide</option>
                    <option value="full">Full</option>
                </select>
            </label>
            
            <button id="themeToggle" onclick="toggleTheme()" title="Toggle theme" style="background: none; border: none; font-size: 1.2rem; cursor: pointer; padding: 0.5rem;">
                üåô
            </button>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="layout">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <!-- Search Section -->
            <div class="sidebar-search">
                <input type="text" id="navSearch" placeholder="Search headings..." autocomplete="off">
            </div>
            
            <!-- Navigation Header -->
            <div class="sidebar-header">
                <h4>Contents</h4>
            </div>
            
            <!-- Scrollable Navigation Area -->
            <div class="sidebar-nav">
                <nav>
                    <ul id="sectionNav">
                        <!-- Will be populated by JavaScript -->
                    </ul>
                    <div id="navNoResults" class="nav-no-results" style="display: none;">
                        No matching headings found
                    </div>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content standard" id="mainContent">
            <h1 id="p≈ô√≠pady-u≈æit√≠">P≈ô√≠pady u≈æit√≠</h1>


<p>Sloupec <strong>Realizace</strong> urƒçuje zp≈Øsob implementace
p≈ô√≠slu≈°n√©ho UC:</p>


<ul>
<li><p>New ‚Äì nov√Ω UC jen pro dan√Ω projekt</p></li>
<li><p>Upd ‚Äì UC upraven√Ω (customizovan√Ω) pro dan√Ω projekt</p></li>
<li><p>AsIs ‚Äì UC beze zmƒõny</p></li>
<li><p>N/A ‚Äì nebude pou≈æ√≠v√°n</p></li>
</ul>


<table>
<caption><p>Tabulka : Seznam p≈ô√≠pad≈Ø u≈æit√≠</p></caption>
<colgroup>
<col style="width: 18%"/>
<col style="width: 46%"/>
<col style="width: 4%"/>
<col style="width: 3%"/>
<col style="width: 3%"/>
<col style="width: 10%"/>
<col style="width: 13%"/>
</colgroup>
<thead>
<tr>
<th><strong>Funkƒçn√≠ oblast</strong></th>
<th><strong>P≈ô√≠pad u≈æit√≠</strong></th>
<th style="text-align: center;"><strong>BO</strong></th>
<th style="text-align: center;"><strong>FO</strong></th>
<th style="text-align: center;"><strong>SC</strong></th>
<th style="text-align: center;"><strong>Realizace</strong></th>
<th><strong>Akt√©r</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="22">Operace s platbami</td>
<td>Zapla≈• p≈ôedplacen√Ω kredit ‚Äì Pre-paid in single domain
(UC.BAR.0.1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>SC User, POS operator</em></td>
</tr>
<tr>
<td>Zapla≈• p≈ôedplacen√Ω kredit ‚Äì Pre-paid in single domain
(UC.BAR.0.1.HR)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>Upd</em></td>
<td><em>SC User, POS operator, System</em></td>
</tr>
<tr>
<td>Zapla≈• depozit (UC.BAR.0.2)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator, SC User,</em> <em>POS operator</em></td>
</tr>
<tr>
<td>Uhraƒè poplatek na FO (UC.BAR.0.3)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>POS operator</em></td>
</tr>
<tr>
<td>Zapla≈• poplatek na FO (UC.BAR.0.3.HR)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>Upd</em></td>
<td><em>POS operator</em></td>
</tr>
<tr>
<td>Vra≈• depozit (UC.BAR.0.4.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Zapla≈• p≈ôedplacen√Ω kredit ‚Äì Pre-paid (UC.BAR.0.5)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>SC User, POS operator</em></td>
</tr>
<tr>
<td>Storno platby (UC.BAR.0.6)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator, POS operator</em></td>
</tr>
<tr>
<td>Naƒçti bankovn√≠ v√Ωpis (UC.BAR.0.7.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Rozpoznej polo≈æku bankovn√≠ho v√Ωpisu (UC.BAR.0.8.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Zru≈° rozpozn√°n√≠ platby (UC.BAR.0.9.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Nap√°ruj fakturu na platbu (UC.BAR.0.10.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Nap√°ruj platbu na fakturu (UC.BAR.0.11.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Odp√°ruj platbu (UC.BAR.0.12.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Nap√°ruj fakturu na fakturu (UC.BAR.0.13.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Odp√°ruj fakturu z faktury (UC.BAR.0.14.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Vra≈• platbu (UC.BAR.0.15.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Schval polo≈æku platebn√≠ho p≈ô√≠kazu (UC.BAR.0.16.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Zmƒõ≈à polo≈æku platebn√≠ho p≈ô√≠kazu (UC.BAR.0.17.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Zam√≠tni polo≈æku platebn√≠ho p≈ô√≠kazu (UC.BAR.0.18.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Vytvo≈ô soubor platebn√≠ch p≈ô√≠kaz≈Ø (UC.BAR.0.19.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Uhraƒè p≈ôestupek (UC.BAR.0.20.HR)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"><em>New</em></td>
<td><em>BO Operator</em></td>
</tr>
<tr>
<td></td>
<td>Zapla≈• Produktov√Ω bal√≠ƒçek (UC.BAR.0.21.HR)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"><em>New</em></td>
<td><em>BO Operator</em></td>
</tr>
<tr>
<td></td>
<td>Zapla≈• OBU (UC.BAR.0.22.HR)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"><em>New</em></td>
<td><em>BO Operator</em></td>
</tr>
<tr>
<td></td>
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>P≈ôesu≈à platbu (UC.BAR.0.30.VO2)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td rowspan="2">Podp≈Ørn√© operace</td>
<td>Naƒçti soubor m√Ωtn√Ωch segment≈Ø (UC.BAR.1.1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
</tr>
<tr>
<td>Operace na vy≈æ√°d√°n√≠ z√°kazn√≠kem</td>
<td>Vytvo≈ô detailn√≠ v√Ωpis m√Ωtn√Ωch transakc√≠ na vy≈æ√°d√°n√≠
(UC.BAR.2.1.VO1)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td><em>WSC User</em></td>
</tr>
<tr>
<td rowspan="3">Operace s fakturami</td>
<td>Vytvo≈ô korekci (UC.BAR.3.1.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Uhraƒè dobropis (UC.BAR.3.2.VO1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Vytvo≈ô proforma fakturu (UC.BAR.3.3.HR)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"><em>New</em></td>
<td><em>BO Operator</em></td>
</tr>
<tr>
<td rowspan="2">Spr√°va slev</td>
<td>Ode≈°li ozn√°men√≠ o nov√©m n√°roku na slevu v dom√©nƒõ CZ
(UC.BAR.4.1)</td>
<td style="text-align: center;"><em>X</em></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
<tr>
<td>Potvrƒè n√°rok na slevu v dom√©nƒõ CZ (UC.BAR.4.2)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><em>N/A</em></td>
<td><em>BO operator</em></td>
</tr>
</tbody>
</table>


<h2 id="operace-s-platbami">Operace s¬†platbami</h2>


<h3 id="zapla≈•-p≈ôedplacen√Ω-kredit-pre-paid-in-single-domain-uc.bar.0.1.hr">Zapla≈•
p≈ôedplacen√Ω kredit ‚Äì Pre-paid in single domain (UC.BAR.0.1.HR)</h3>


<h4 id="c√≠l">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu u≈æit√≠ je nav√Ω≈°en√≠ p≈ôedplacen√©ho kreditu Pre-paid
√∫ƒçtu.</p>


<h4 id="akt√©≈ôi-1">Akt√©≈ôi</h4>


<p>POS Operator, System, Customer</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>P≈ô√≠pad u≈æit√≠ je vlo≈æenou souƒç√°st√≠ p≈ô√≠padu u≈æit√≠:</p>


<ul>
<li><p><mark>Dobi predplaten√Ω kredit (UC.VCM.4.2)</mark>,</p></li>
</ul>


<p>Na z√°kladƒõ po≈æadavku na Top-up z rozhran√≠:</p>


<ul>
<li><p>Rozhran√≠ ERP Navision (INT.BAR.30.HR)</p></li>
<li><p>Rozhran√≠ Web portal API (INT.BAR.33.HR)</p></li>
<li><p>Rozhran√≠ intern√≠ POS API (INT.BAR.34.HR)</p></li>
<li><p>Rozhran√≠ intern√≠ KIOSK API (INT.BAR.35.HR)</p></li>
<li><p>Rozhran√≠ intern√≠ IEFBO API (INT.BAR.36.HR)</p></li>
</ul>


<ul>
<li></li>
</ul>


<h4 id="podm√≠nky-spu≈°tƒõn√≠">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Account je zn√°m.</p>


<p>Account type je Pre-paid.</p>


<p><mark>Account nen√≠ terminovan√Ω.</mark></p>


<p><mark>Pokud Customer nen√≠ anonymn√≠ (tj. Anonymous registration =
false) a z√°rove≈à Account status je Terminated, Syst√©m p≈ôenastav√≠ Account
do stavu Active?</mark></p>


<p>V√Ω≈°e top-up je zn√°ma.</p>


<p>Bill issuer je zn√°m (tj. System operator).</p>


<p>Zp≈Øsob platby je zn√°m.</p>


<p>P≈ô√≠padnƒõ POS je zn√°ma.</p>


<h4 id="norm√°ln√≠-postup">Norm√°ln√≠ postup</h4>


<p>(N1) P≈ôedpla≈• kredit na vlastn√≠ POS, extern√≠ POS, Kiosku nebo MEV</p>


<p>Syst√©m zobraz√≠ aktu√°ln√≠ v√Ω≈°i balance (BM.Balance.amount -
BM.Balance.Reservation amount - <mark>Grace period amount</mark>).</p>


<p>Syst√©m zobraz√≠ minim√°ln√≠ zaokrouhlenou v√Ω≈°i kreditu:</p>


<ul>
<li><p>Pokud aktu√°ln√≠ balance &lt; 0, pak MAX (absolutn√≠ hodnota
aktu√°ln√≠ v√Ω≈°e balance; BAR.Currency.Minimum top-up amount),</p></li>
<li><p>jinak BAR.Currency.Minimum top-up amount.</p></li>
</ul>


<p>Akt√©r vybere ƒç√°stku z¬†p≈ôeddefinovan√Ωch hodnot (tj. Currency.GUI
top-up value 1-4) nebo Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku minim√°ln√≠ho
top-up.</p>


<p>Syst√©m zkontroluje, zda ƒç√°stka je &lt;= hodnotƒõ Currency.Max Top-up,
pokud nen√≠, Akt√©r je vyzv√°n k √∫pravƒõ ƒç√°stky top-up.</p>


<p>Pokud zadan√° ƒç√°stka kreditu (zaokrouhlen√° na cel√© ƒç√≠slo), je vy≈°≈°√≠
ne≈æ hodnota Currency.MaxTop-upCash, Syst√©m neumo≈æn√≠ vybrat platbu v
hotovosti.</p>


<p>Akt√©r m≈Ø≈æe vybrat, zda se z√°rove≈à m√° tokenizovat platebn√≠ karta.</p>


<p>Postup pokraƒçuje realizac√≠ platby top-up za pou≈æit√≠ p≈ô√≠padu u≈æit√≠
Zapla≈• poplatek na POS (UC.BAR.0.3.HR).</p>


<p>(N2) P≈ôedpla≈• kredit na Web Portal nebo Mobile app - online platba
p≈ôes platebn√≠ br√°nu</p>


<p>Placen√≠ z¬†Web port√°lu nebo Mobile App je pops√°no v¬†syst√©mov√© funkci
Zprocesuj transakci platebn√≠ kartou (API.BAR.0.1.HR):</p>


<ul>
<li><p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o v√Ω≈°i zadan√©ho Top-up, Bill issuer a Account.</p></li>
<li><p>Syst√©m realizuje Online platbu p≈ôes CorvusPay platebn√≠ br√°nu za
pou≈æit√≠ syst√©mov√© funkce Zapla≈• ud√°lost online p≈ôes platebn√≠ br√°nu
(SYS.BAR.2.15.HR).</p></li>
<li><p>Pokud transakce byla √∫spƒõ≈°n√° (tj.Payment session.status =
Realized), proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</p></li>
<li></li>
<li><p>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, potvrd√≠ extern√≠mu
syst√©mu √∫spƒõ≈°nou realizaci platby a vr√°t√≠ identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p><mark>(N3) P≈ôedpla≈• kredit na Web Portal nebo Mobile app ‚Äì jin√°
platebn√≠ metoda ne≈æ online platba p≈ôes platebn√≠ br√°nu</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o v√Ω≈°i zaplacen√©ho Top-up, typu platebn√≠ metody (nap≈ô
SMS, Voucher), Bill issuer a Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ Web portal API
(INT.BAR.33.HR).</mark></p>


<p><mark>(N4) P≈ôedpla≈• kredit</mark> <mark>p≈ôes HR Toll
aplikaci</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠</mark> <mark>HR Toll</mark>
<mark>API (INT.BAR.34.HR) obdr≈æ√≠ informaci o v√Ω≈°i zaplacen√©ho Top-up,
typ platebn√≠ metody, Bill issuer a Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ POS API
(INT.BAR.34.HR).</mark></p>


<p>(N5) <mark>P≈ôedpla≈• kredit</mark> bankovn√≠m p≈ôevodem na z√°kladƒõ
Proforma faktury</p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ ERP Navision (INT.BAR.30.HR)
obdr≈æ√≠ informaci o v√Ω≈°i zaplacen√©ho Top-up, typ platebn√≠ metody (bank
transfer), Proforma bill, Bill issuer.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</mark></p>


<p>Spoleƒçn√Ω postup pro v≈°echny platebn√≠ metody</p>


<p>Syst√©m o ƒç√°stku top-up platby nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu,
pou≈æije se p≈ô√≠pad u≈æit√≠ Aktualizuj z≈Østatek (SYS.BM.1.2.HR) s d≈Øvodem
updatu balance = TopUp.</p>


<p>Syst√©m zjist√≠ √∫daje o top-up na z√°kladƒõ Bill issuer, <mark>Bill
issuer VAT registration country, VAT registration country z√°kazn√≠ka, VAT
registration country z√°kazn√≠ka,</mark> Product type = Top-up a Event
attribute Top-up = Top-up (za pou≈æit√≠ p≈ô√≠padu u≈æit√≠ Z√≠skej produkt
(SYS.PCRE.1.2.HR)).</p>


<p>Syst√©m vygeneruje jednor√°zovou fakturu za m√Ωto za u≈æit√≠ syst√©mov√©
funkce Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p>


<p>Syst√©m nap√°ruje novƒõ vytvo≈ôen√Ω Bill na novƒõ vytvo≈ôen√Ω Payment, tj.
vytvo≈ô√≠ Matching s¬†n√°sleduj√≠c√≠mi parametry:</p>


<ul>
<li><p>Date of matching = aktu√°ln√≠ datum</p></li>
<li><p>Effective date of matching = vy≈°≈°√≠ z¬†datum≈Ø p√°rovan√Ωch stran (tj.
payment.date of collection, bill.date od end)</p></li>
<li><p>Bill ‚Äì debit matching side = vytvo≈ôen√Ω Bill</p></li>
<li><p>Payment ‚Äì credit matching side = vytvo≈ôen√Ω Payment</p></li>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up</p></li>
<li><p>Matching method = Automatic</p></li>
<li><p>Disconnect allowed = True</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Bill:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Bill.total
amount),</p></li>
<li><p>Bill payment status = Paid fully.</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Payment:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Payment
amount),</p></li>
<li><p>Matching status = Recognized ‚Äì matched.</p></li>
</ul>


<p><mark>Pokud ≈°lo o platbu tankovac√≠ kartou, Syst√©m zagreguje platbu do
odpov√≠daj√≠c√≠ho FCI RfP, vyu≈æit√≠m p≈ô√≠padu u≈æit√≠ Zagreguj platby tankovac√≠
kartou do FCI RfP (SYS.BAR.0.9).</mark></p>


<p>Postup konƒç√≠.</p>


<h4 id="alternativn√≠-postupy">Alternativn√≠ postupy </h4>


<p><u>(A1) Bez platby ‚Äì Proforma (na BO, vlastn√≠ POS, extern√≠ POS nebo
MEV )</u></p>


<p>Pokud Akt√©r bude cht√≠t jako platebn√≠ metodu bankovn√≠ p≈ôevod, iniciuje
vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)) zm√°ƒçknut√≠m p≈ô√≠slu≈°n√©ho
tlaƒç√≠tka a spu≈°tƒõn√≠m p≈ô√≠padu u≈æit√≠ Vytvo≈ô proforma fakturu
(UC.BAR.3.3.HR).</p>


<p>Postup konƒç√≠.</p>


<p>Postup konƒç√≠.</p>


<p>(A2) Bez platby‚Äì Proforma (Web portal nebo Mobile app)</p>


<p>Pokud Z√°kazn√≠k na exern√≠m Web port√°lu nebo Mobile app bude cht√≠t jako
platebn√≠ metodu bankovn√≠ p≈ôevod, Syst√©m na vstupu p≈ôes Rozhran√≠ Web
portal API (INT.BAR.33.HR) obdr≈æ√≠ informaci o v√Ω≈°i po≈æadovan√©ho Top-up,
Bill issuer a Account, tzn. ≈æe z√°kazn√≠k m√° z√°jem o vytvo≈ôen√≠ nab√≠dky
(tj. Proforma faktury (Offer)), kterou chce zaplatit bankovn√≠m p≈ôevodem.
Operace je realizov√°na za pou≈æit√≠ syst√©mov√© funkce Vygeneruj proforma
fakturu (API.BAR.1.1.HR): </p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p>Postup konƒç√≠.</p>


<h4 id="chybov√©-postupy">Chybov√© postupy</h4>


<p>Ne√∫spƒõ≈°n√° transakce</p>


<blockquote>
<p>Pokud transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status =
Rejected), Syst√©m informuje Akt√©ra o ne√∫spƒõ≈°n√© transakci (pokud proces
byl inicializov√°n v¬†r√°mci Syst√©mu) a Akt√©r m≈Ø≈æe pokraƒçovat od zaƒç√°tku
√∫pravou v√Ω≈°e Top-up nebo proces ukonƒçit.</p>
<p><u>Ne√∫spƒõ≈°n√° online transakce</u></p>
<p>Pokud transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status =
Rejected), Syst√©m vr√°t√≠ odpov√≠daj√≠c√≠ result extern√≠mu syst√©mu (pokud
proces byl inicializov√°n z¬†extern√≠ho syst√©mu).</p>
</blockquote>


<h4 id="grafick√©-rozhran√≠">Grafick√© rozhran√≠</h4>


<p>N/A</p>


<h4 id="pozn√°mky">Pozn√°mky</h4>


<p>Nejsou</p>


<h3 id="zapla≈•-poplatek-na-pos-uc.bar.0.3.hr">Zapla≈• poplatek na POS
(UC.BAR.0.3.HR)</h3>


<h4 id="c√≠l-1">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu u≈æit√≠ je zaplacen√≠ poplatku p≈ôi vystaven√≠
jednor√°zov√© faktury na vlastn√≠ nebo extern√≠ POS pou≈æ√≠vaj√≠c√≠ POS
aplication.</p>


<h4 id="akt√©≈ôi-2">Akt√©≈ôi</h4>


<p>POS Operator, Customer</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu-1">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>Je vlo≈æenou souƒç√°st√≠ p≈ô√≠padu u≈æit√≠:</p>


<ul>
<li><p>Top-up</p>
<ul>
<li><p>Zapla≈• p≈ôedplacen√Ω kredit ‚Äì Pre-paid in single domain
(UC.BAR.0.1.HR)</p>
<ul>
<li><p>na POS, extern√≠ POS, Kiosku nebo MEV</p></li>
</ul></li>
</ul></li>
<li><p>P≈ôestupek</p>
<ul>
<li><p>Uhraƒè p≈ôestupek (UC.BAR.0.20.HR)</p>
<ul>
<li><p>na POS, extern√≠ POS, Kiosku nebo MEV</p></li>
</ul></li>
</ul></li>
<li><p>OBU</p>
<ul>
<li><p>Zapla≈• OBU (UC.BAR.0.22.HR), Objednaj OBU (UC.VCM.2.8)</p>
<ul>
<li><p>na POS, extern√≠ POS nebo MEV</p></li>
</ul></li>
</ul></li>
<li><p>Produktov√Ω bal√≠ƒçek</p>
<ul>
<li><p>Zapla≈• Produktov√Ω bal√≠ƒçek (UC.BAR.0.21.HR), Pridaj produktov√Ω
bal√≠ƒçek (UC.VCM.1.6)</p>
<ul>
<li><p>na POS, <mark>extern√≠ POS</mark>,</p></li>
</ul></li>
</ul></li>
<li><p>OBU p≈ô√≠slu≈°enstv√≠</p>
<ul>
<li><p>Prodej p≈ô√≠slu≈°enstv√≠ OBU na POS (UC.OL.1.7.HR)</p>
<ul>
<li><p>na POS, extern√≠ POS,</p></li>
</ul></li>
</ul></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li><p><mark>VCM poslani OBU</mark> </p></li>
</ul>


<h4 id="podm√≠nky-spu≈°tƒõn√≠-1">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Kan√°l prodeje je vlastn√≠ nebo extern√≠ POS (je zn√°ma POS a Bill
issuer) nebo MEV nebo Kiosk.</p>


<p>Je zn√°ma ƒç√°stka k¬†√∫hradƒõ, p≈ô√≠padnƒõ ocenƒõn√° ud√°lost a typ operace
(top-up, placen√≠ offence, prodej OBU, prodej produktu, objedn√°n√≠ OBU,
objedn√°n√≠ produktu...).</p>


<p>Volitelnƒõ je zn√°m Account.</p>


<p><mark>Account nen√≠ terminovan√Ω.</mark></p>


<h4 id="norm√°ln√≠-postup-1">Norm√°ln√≠ postup</h4>


<p>Syst√©m zobraz√≠ ƒç√°stku na zaplacen√≠ s p≈ôesnost√≠ na dvƒõ desetinn√°
m√≠sta.</p>


<p>Akt√©r vybere platebn√≠ metodu:</p>


<ul>
<li><p>Na vlastn√≠ a extern√≠ POS jsou dostupn√©:</p>
<ul>
<li><p>platba bankovn√≠ a palivovou kartou p≈ôes EFT (NexGo
(INT.BAR.28.HR)) s¬†mo≈ænost√≠ tokenizace karty p≈ôi top-up</p></li>
<li><p>hotovost</p></li>
<li><p><mark>bankovn√≠m p≈ôevodem (vystav√≠ se jen Offer s¬†platebn√≠mi
√∫daji).</mark></p></li>
</ul></li>
<li><p>Na KIOSKU jsou dostupn√©:</p>
<ul>
<li><p>platba bankovn√≠ a palivovou kartou p≈ôes EFT (Ingenico (rozhran√≠
INT.BAR.29.HR))</p></li>
</ul></li>
<li><p>Na MEV jsou dostupn√©:</p>
<ul>
<li><p>platba bankovn√≠ a palivovou kartou p≈ôes EFT (NexGo
(INT.BAR.28.HR)) s¬†mo≈ænost√≠ tokenizace karty p≈ôi top-up</p></li>
<li><p>hotovost</p></li>
</ul></li>
</ul>


<p>Pozn√°mka: platba bankovn√≠ a palivovou kartou p≈ôes HR Toll app v EFT
(NexGo (INT.BAR.28.HR)) je ≈ôe≈°ena v¬†r√°mci syst√©mov√© funkce Zapla≈•
ud√°lost platbou z extern√≠ho syst√©mu (SYS.BAR.2.16.HR)</p>


<p>(N1) Bank card nebo Fleet card payment p≈ôes termin√°l na POS nebo
MEV</p>


<p>Akt√©r vlo≈æ√≠ kartu do EFT termin√°lu p≈ôes Rozhran√≠ EFT Terminal NexGo
(INT.BAR.28.HR).</p>


<p>EFT terminal rozpozn√° platbu bankovn√≠/tankovac√≠ kartou.</p>


<p>EFT terminal autorizuje platbu pomoc√≠ karetn√≠ho autorizaƒçn√≠ho centra.
V¬†p≈ô√≠padƒõ, ≈æe EFT terminal zam√≠tne autorizaci, Syst√©m zobraz√≠ informaci,
≈æe ‚ÄúPlatba nebyla autorizov√°na‚Äù a postup pokraƒçuje opƒõtovnou volbou
platebn√≠ metody.</p>


<p>Syst√©m z√≠sk√° data o platbƒõ a p≈ô√≠padnƒõ tak√© o tokenu z¬†EFT termin√°lu
z¬†Rozhran√≠ EFT Terminal NexGo (rozhran√≠ INT.BAR.28.HR).</p>


<p>Syst√©m vytvo≈ô√≠ Payment Session:</p>


<ul>
<li><p>Online payment identifier = ƒç√≠slo transakce z¬†EFT</p></li>
<li><p>Payment session type =</p>
<ul>
<li><p>Top-up, pokud Product type = Top-up</p></li>
<li><p><mark>Offence, pokud jde o placen√≠ p≈ôestupk≈Ø (placen√≠ UTT ve
stavu Offence),</mark></p></li>
<li></li>
<li><p>Offence RfP payment, pokud jde o placen√≠ RfP za
p≈ôestupky,</p></li>
<li><p>jinak Services.</p></li>
</ul></li>
<li><p>Payment session status = Realized</p></li>
<li><p>Payment amount = ƒç√°stka platby z¬†EFT</p></li>
<li><p>Variable symbol = vygenerovan√Ω ze sekvence pro variabiln√≠ symboly
(PNFVS)</p></li>
<li><p>Internet banking channel = EFT payment</p></li>
<li><p>Created on = aktu√°ln√≠ datum a ƒças</p></li>
<li><p>Authorization code = autorizaƒçn√≠ k√≥d z¬†EFT</p></li>
<li><p>Result code = n√°vratov√Ω k√≥d z¬†EFT</p></li>
<li><p>Card type = Typ karty z¬†EFT</p></li>
<li><p>Card expiry = Expirace karty z¬†EFT</p></li>
<li><p>Card number = ƒå√≠slo karty z¬†EFT</p></li>
<li><p>Card brand = Brand karty z¬†EFT</p></li>
<li><p>Card token = Token karty z EFT</p></li>
<li><p>EFT terminal = Identifik√°tor platebn√≠ho termin√°lu z¬†EFT</p></li>
</ul>


<p>Pokud na vstupu byla po≈æadov√°na z√°rove≈à tokenizace platebn√≠ karty,
Syst√©m z√≠skan√Ω token a informace o Payment card ulo≈æ√≠ na Accountu za
pou≈æit√≠ syst√©mov√© funkce Pridaj platobn√∫ kartu (SYS.VCM.4.1).</p>


<p>(N2) Bank card nebo Fleet card payment p≈ôes termin√°l na KIOSKu</p>


<p>Akt√©r vlo≈æ√≠ kartu do EFT termin√°lu p≈ôes Rozhran√≠ EFT Terminal
Ingenico (INT.BAR.29.HR).</p>


<p>EFT terminal rozpozn√° platbu bankovn√≠/tankovac√≠ kartou.</p>


<p>EFT terminal autorizuje platbu pomoc√≠ karetn√≠ho autorizaƒçn√≠ho centra.
V¬†p≈ô√≠padƒõ, ≈æe EFT terminal zam√≠tne autorizaci, Syst√©m zobraz√≠ informaci,
≈æe ‚ÄúPlatba nebyla autorizov√°na‚Äù a postup pokraƒçuje opƒõtovnou volbou
platebn√≠ metody.</p>


<p>Syst√©m z√≠sk√° data o platbƒõ z¬†EFT termin√°lu z¬†Rozhran√≠ EFT Terminal
Ingenico (INT.BAR.29.HR).</p>


<p>Syst√©m vytvo≈ô√≠ Payment Session:</p>


<ul>
<li><p>Online payment identifier = ƒç√≠slo transakce z¬†EFT</p></li>
<li><p>Payment session type =</p>
<ul>
<li><p>Top-up, pokud Product type = Top-up</p></li>
<li></li>
<li><p>Offence RfP payment, pokud jde o placen√≠ RfP za
p≈ôestupky,</p></li>
<li><p>jinak Services.</p></li>
</ul></li>
<li><p>Payment session status = Realized</p></li>
<li><p>Payment amount = ƒç√°stka platby z¬†EFT</p></li>
<li><p>Variable symbol = vygenerovan√Ω ze sekvence pro variabiln√≠ symboly
(PNFVS)</p></li>
<li><p>Internet banking channel = EFT payment</p></li>
<li><p>Created on = aktu√°ln√≠ datum a ƒças</p></li>
<li><p>Authorization code = autorizaƒçn√≠ k√≥d z¬†EFT</p></li>
<li><p>Result code = n√°vratov√Ω k√≥d z¬†EFT</p></li>
<li><p>Card type = Typ karty z¬†EFT</p></li>
<li><p>Card expiry = Expirace karty z¬†EFT</p></li>
<li><p>Card number = ƒå√≠slo karty z¬†EFT</p></li>
<li><p>Card brand = Brand karty z¬†EFT</p></li>
<li><p>EFT terminal = Identifik√°tor platebn√≠ho termin√°lu z¬†EFT</p></li>
</ul>


<p>(N3) Hotovost na POS nebo MEV</p>


<p><mark>Syst√©m pot≈ôebnou ƒç√°stku za poplatek placenou hotovost√≠
zaokrouhl√≠ na nejbli≈æ≈°√≠ pƒõticent (tj. 102,02 ü°™ 102,00; 102,03 ü°™ 102,05;
102,26 ü°™ 102,25; 99,97 ü°™ 99,95; 99,98 ü°™ 100,00).</mark></p>


<p>Akt√©r p≈ôevezme zaokrouhlenou ƒç√°stku v hotovosti od z√°kazn√≠ka a
zaregistruje Platbu.</p>


<p>Spoleƒçn√Ω postup pro v≈°echny platebn√≠ metody</p>


<p>Syst√©m zjist√≠ BIBA pro fakturaci na z√°kladƒõ Bill issuer ze vstupu a
Reason:</p>


<ul>
<li><p>Offence, pokud jde o Offence operaci</p></li>
<li><p>Top-up, pokud jde o Top-up operaci</p></li>
<li><p><mark>OBU, pokud jde o OBU operaci</mark></p></li>
<li><p>Product, pokud jde o Product package operaci</p></li>
<li><p>jinak Services.</p></li>
</ul>


<p>Syst√©m vytvo≈ô√≠ Payment s¬†parametry:</p>


<ul>
<li><p>Payment number = Unik√°tn√≠ ƒç√≠slo platby podle ƒç√≠slovac√≠ho
sch√©matu.</p></li>
<li><p>Payment type =</p>
<ul>
<li><p>Top-up payment, pokud jde o Top-up operaci,</p></li>
<li><p>Offence payment, pokud jde o placen√≠ Offence RfP
operaci,</p></li>
<li><p>OBU payment, pokud jde o OBU operaci,</p></li>
<li><p>OBU accessories payment, pokud jde o OBU accessories
operaci,</p></li>
<li><p>Product payment, pokud jde o Product package operaci,</p></li>
<li><p>jinak Bill payment.</p></li>
</ul></li>
<li><p>Payment method =</p>
<ul>
<li><p>pokud Payment session.internet banking channel = EFT payment a
Card type m√° Card type.type = Bank card, pak Bank card payment,</p></li>
<li><p>pokud Payment session.internet banking channel = EFT payment a
Card type m√° Card type.type = Fleet card, pak Fleet card
payment,</p></li>
<li><p>pokud na vstupu byla platebn√≠ metoda Cash, pak Cash
payment.</p></li>
</ul></li>
<li><p>Payment category = Credit payment</p></li>
<li><p>Payment status = Realized</p></li>
<li><p>Matching status = Recognized ‚Äì not matched</p></li>
<li><p>Variable symbol = Variable symbol z¬†Payment session, pokud
existuje, jinak Null</p></li>
<li><p>Specific symbol = Subject number</p></li>
<li><p>Payment amount = ƒç√°stka platby</p></li>
<li><p>Matched amount = 0</p></li>
<li><p>Date of payment = aktu√°ln√≠ datum</p></li>
<li><p>Date of collection = aktu√°ln√≠ datum</p></li>
<li><p>Comment = null</p></li>
<li><p>Subject type = Account</p></li>
<li><p>Subject number = VCM.VT Account.number</p></li>
<li><p>POS = obchodn√≠ m√≠sto, kde byla provedena platba</p></li>
<li><p>FCI = FCI karty, v¬†p≈ô√≠padƒõ platby tankovac√≠ kartou</p></li>
<li><p>Bill issuer bank account = zji≈°tƒõn√© ƒç√≠slo bankovn√≠ho √∫ƒçtu Bill
issuera (BIBA)</p></li>
<li><p>Bill issuer = Bill issuer ze vstupu</p></li>
</ul>


<p><mark>Pokud ≈°lo o platbu tankovac√≠ kartou, Syst√©m zagreguje platbu do
odpov√≠daj√≠c√≠ho FCI RfP, vyu≈æit√≠m p≈ô√≠padu u≈æit√≠ Zagreguj platby tankovac√≠
kartou do FCI RfP (SYS.BAR.0.9).</mark></p>


<p>Postup konƒç√≠.</p>


<h4 id="alternativn√≠-postupy-1">Alternativn√≠ postupy</h4>


<p>Nejsou</p>


<h4 id="chybov√©-postupy-1">Chybov√© postupy</h4>


<p>Nejsou</p>


<h4 id="grafick√©-rozhran√≠-1">Grafick√© rozhran√≠</h4>


<p>POS:</p>


<h3 id="uhraƒè-p≈ôestupek-uc.bar.0.20.hr">Uhraƒè p≈ôestupek
(UC.BAR.0.20.HR)</h3>


<ol type="1">
<li><p>C√≠l</p></li>
</ol>


<blockquote>
<p>C√≠lem tohoto p≈ô√≠padu u≈æit√≠ je uhradit jeden nebo v√≠ce V√Ωzev na √∫hradu
(Offence RfP), ve kter√Ωch je zahrnut p≈ôestupek a z√°konn√° pokuta.</p>
</blockquote>


<ol start="2" type="1">
<li><p>Akt√©≈ôi</p></li>
</ol>


<blockquote>
<p>Offence Portal User, POS Operator, Customer, System</p>
</blockquote>


<ol start="3" type="1">
<li><p>Spu≈°tƒõn√≠ p≈ô√≠padu</p></li>
</ol>


<p>Offence portal:</p>


<ul>
<li><p>Otev≈ôen√≠ str√°nky Offence port√°lu, a zad√°n√≠ Registraƒçn√≠ znaƒçky
vozidla a PIN, kter√Ω byl vygenerov√°n pro danou registraƒçn√≠ znaƒçku a
kter√Ω provozovatel vozidla obdr≈æel v dopise po vygenerov√°n√≠ V√Ωzvy na
√∫hradu dan√©ho vozidla.</p></li>
<li><p>Otev≈ôen√≠ linku a zad√°n√≠ PIN, kter√Ω provozovatel vozidla obdr≈æel v
dopise po vygenerov√°n√≠ V√Ωzvy na √∫hradu dan√©ho vozidla. (Pozn√°mka: Link
obsahuje jak registraƒçn√≠ znaƒçku tak zemi registrace, tak≈æe nen√≠ pot≈ôeba
je ji≈æ vypl≈àovat. Mus√≠ se zadat jen PIN vygenerovan√Ω pro danou
SPZ).</p></li>
<li><p><mark>Anonymn√≠ registrac√≠ na str√°nce Offence port√°lu</mark>
<mark>za</mark> <mark>pou≈æit√≠</mark> <mark>p≈ô√≠padu u≈æit√≠ Zaregistruj
vozidlo cez Offence Portal</mark> <mark>(UC.VCM.1.7.HR)</mark></p></li>
<li><p>P≈ôihl√°≈°en√≠m do Offence port√°lu na z√°kladƒõ z√°kaznick√Ωch
p≈ôihla≈°ovac√≠ch √∫daj≈Ø za pou≈æit√≠ syt√©mov√© funkce P≈ôihla≈° u≈æivatele
(UC.AC.21).</p></li>
</ul>


<p>POS, MEV:</p>


<ul>
<li><p>Zad√°n√≠m Registraƒçn√≠ znaƒçky vozidla, pro kter√© se maj√≠ naj√≠t
P≈ôestupky.</p></li>
<li><p>P≈ô√≠padnƒõ zad√°n√≠m Customera nebo Accountu, pro jeho≈æ vozidla se
maj√≠ naj√≠t p≈ôestupky.</p></li>
</ul>


<p>KIOSK:</p>


<ul>
<li><p>Rozpoznan√° Registraƒçn√≠ znaƒçka vozidla, pro kter√© se maj√≠ naj√≠t
P≈ôestupky.</p></li>
<li></li>
</ul>


<p>Na z√°kladƒõ po≈æadavku na zaplacen√≠ P≈ôestupku z rozhran√≠:</p>


<ul>
<li><p>Rozhran√≠ ERP Navision (INT.BAR.30.HR)</p></li>
<li><p>Rozhran√≠ Web portal API (INT.BAR.33.HR)</p></li>
<li><p>Rozhran√≠ POS API (INT.BAR.34.HR)</p></li>
<li><p>Rozhran√≠ KIOSK API (INT.BAR.35.HR)</p></li>
<li><p>Rozhran√≠ IEFBO API (INT.BAR.36.HR)</p>
<ol type="1">
<li><p>Podm√≠nky spu≈°tƒõn√≠</p></li>
</ol></li>
</ul>


<blockquote>
<p>Je zn√°mo vozidlo, √∫ƒçet nebo z√°kazn√≠k na kter√©m se maj√≠ uhradit
P≈ôestupky.</p>
</blockquote>


<ol start="2" type="1">
<li><p>Norm√°ln√≠ postup</p></li>
</ol>


<blockquote>
<p>Syst√©m vyhled√° v≈°echny V√Ωzvy na √∫hradu za p≈ôestupky (tj. Bill s Bill
type = Request for payment, a Bill issue type = Regular bill nebo
Simplified bill, a Bill category = Offence, a Bill payment status =
Unpaid nebo Paid Partially a kde z√°rove≈à je Matched Amount &lt; Total
amount) pro:</p>
</blockquote>


<ul>
<li><p>Registraƒçn√≠ znaƒçky v≈°ech vozidel dan√©ho z√°kazn√≠ka, pokud je zn√°m
ze vstupu jen z√°kazn√≠k (nap≈ô. do≈°lo k p≈ôihl√°≈°en√≠ existuj√≠c√≠ho z√°kazn√≠ka)
(subject RfP nen√≠ limitov√°n z√°kazn√≠kem),</p></li>
<li><p>pro Registraƒçn√≠ znaƒçky v≈°ech vozidel dan√©ho √∫ƒçtu, pokud je zn√°m
ze vstupu jen √∫ƒçet (nap≈ô. p≈ôi≈°el po≈æadavek z Web selfcare) (subject RfP
nen√≠ limitov√°n √∫ƒçtem),</p></li>
<li><p>pro danou Registraƒçn√≠ znaƒçku, pokud je zn√°ma ze vstupu
Registraƒçn√≠ znaƒçka vozidla (nap≈ô. p≈ôihl√°≈°en√≠ za pomoc√≠ linku a PIN nebo
na Kiosku).</p></li>
</ul>


<blockquote>
<p>Syst√©m zobraz√≠ √∫vodn√≠ p≈ôehled obsahuj√≠c√≠ maxim√°lnƒõ 3 polo≈æky. Ka≈æd√°
polo≈æka bude souƒçtem nalezen√Ωch V√Ωzev na √∫hradu seƒçten√Ωch per Bill
issuer s detaily:</p>
</blockquote>


<ul>
<li><p>Toll charger ü°™ Bill.bill issuer</p></li>
<li><p>Time period ü°™ MIN(Bill.date of issue) a MAX(Bill.date of
issue)</p></li>
<li><p>Amount to pay ü°™ SUM(Bill.total amount ‚Äì Bill.matched
amount)</p></li>
</ul>


<blockquote>
<p>Pokud jde o Kiosek, z √∫vodn√≠ho p≈ôehledu Akt√©r m≈Ø≈æe ka≈ædou jednotlivou
souhrnnou polo≈æku zaplatit nebo p≈ôeskoƒçit proces placen√≠ p≈ôestupk≈Ø.</p>
<p>Pokud nejde o Kiosek, z √∫vodn√≠ho p≈ôehledu Akt√©r m≈Ø≈æe ka≈ædou
jednotlivou souhrnnou polo≈æku zaplatit nebo zobrazit si jej√≠ detail.</p>
</blockquote>


<ul>
<li></li>
</ul>


<blockquote>
<p>Pokud akt√©r vybral zaplacen√≠ konkr√©tn√≠ souhrnn√© polo≈æky, postup
pokraƒçuje (N1) Zapla≈• p≈ôestupek online.</p>
<p>Pokud Akt√©r vybere zobrazen√≠ detailu, Syst√©m zobraz√≠ polo≈æky zahrnut√©
do dan√© vybran√© souhrnn√© polo≈æky = p≈ôehled aktu√°lnƒõ evidovan√Ωch V√Ωzev na
√∫hrady dan√©ho Bill issuera s mo≈ænost√≠ ka≈ædou vybrat pro zaplacen√≠ nebo
zobrazit jej√≠ detaily:</p>
</blockquote>


<ul>
<li><p>Bill.bill issuer</p></li>
<li><p>Bill.registration number + .registration country</p></li>
<li></li>
<li><p>Account.number</p></li>
<li><p>Customer.number</p></li>
<li><p>Customer.full name</p></li>
<li><p>Bill.date of issue</p></li>
<li><p>Bill.total amount ‚Äì Bill.matched amount</p></li>
<li><ul>
<li></li>
</ul></li>
<li><p>Unpaid Toll Transaction s mo≈ænost√≠ zobrazit detaily:</p>
<ul>
<li><p>Unpaid Toll Transaction.event time (by default se≈ôazen√© podle
Event time)</p></li>
<li><p>Unpaid Toll Transaction.transaction amount</p></li>
<li><p>Unpaid Toll Transaction.toll trip ü°™ VTP.Toll trip (entry ‚Äì
exit)</p></li>
<li><p>Unpaid Toll Transaction.toll trip ü°™ Pictures (mo≈ænost zobrazit a
st√°hnout fotky)</p></li>
</ul></li>
<li></li>
<li><p>Legal penalty s detaily:</p>
<ul>
<li><p>Bill item.billing service name</p></li>
<li></li>
<li><p>Bill item.price amount VAT</p></li>
</ul></li>
</ul>


<p>Akt√©r vybere jednu nebo v√≠ce polo≈æek v detailu souhrnn√© polo≈æky.
Syst√©m s ka≈ædou vybranou polo≈ækou zobrazuje celkov√Ω souƒçet k zaplacen√≠
(tj. SUM(Bill.total amount ‚Äì Bill.matched amount)).</p>


<p>Akt√©r potvrd√≠, ≈æe je chce uhradit.</p>


<p>(N1) Zapla≈• p≈ôestupek online</p>


<blockquote>
<p>Zaplatit p≈Øjde i souhrnn√° polo≈æka, jej√≠≈æ polo≈æky pat≈ô√≠ jednomu, v√≠ce
nebo ≈æ√°dn√©mu Accountu nebo v√Ωbƒõr RfP, pat≈ô√≠ jednomu, v√≠ce nebo ≈æ√°dn√©mu
Accountu:</p>
</blockquote>


<ul>
<li><p>Pokud p≈ôihl√°≈°en√≠ probƒõhlo vytvo≈ôen√≠m nov√©ho anonymn√≠ho z√°kazn√≠ka,
pro identifikaci subjektu platby se pou≈æije jeho nov√Ω Account.</p></li>
<li><p>Pokud je zn√°ma Registraƒçn√≠ znaƒçka vozidla a z√°kazn√≠k, jako
subject platby se pou≈æije subjekt nejnovƒõj≈°√≠ho vybran√©ho RfP dan√©
Registraƒçn√≠ znaƒçky dan√©ho z√°kazn√≠ka.</p></li>
<li><p>Pokud se p≈ôihl√°sil st√°vajic√≠ z√°kazn√≠k nebo je zn√°m jen Customer
ze vstupu, pro identifikaci subjektu platby se pou≈æije subjekt
nejnovƒõj≈°√≠ho vybran√©ho RfP dan√©ho z√°kazn√≠ka.</p></li>
<li><p>Pokud je zn√°m jen Account ze vstupu, pou≈æije se jako subjekt
platby.</p></li>
<li><p>Pokud je zn√°ma jen Registraƒçn√≠ znaƒçka vozidla, jako subject
platby se pou≈æije subjekt nejnovƒõj≈°√≠ho vybran√©ho RfP dan√© Registraƒçn√≠
znaƒçky.</p></li>
</ul>


<blockquote>
<p>Syst√©m realizuje Online platbu p≈ôes CorvusPay platebn√≠ br√°nu za
pou≈æit√≠ syst√©mov√©</p>
</blockquote>


<p>funkce Zapla≈• ud√°lost online p≈ôes platebn√≠ br√°nu
(SYS.BAR.2.15.HR).</p>


<p>Spoleƒçn√Ω postup pro v≈°echny platebn√≠ metody</p>


<p>Syst√©m:</p>


<ul>
<li><p>na z√°kladƒõ ka≈æd√© zaplacen√© Unpaid Toll Transaction vytvo≈ô√≠
odpov√≠daj√≠c√≠ Toll Transaction ve stavu Processed, kdy se zkop√≠ruj√≠
hodnoty odpov√≠daj√≠c√≠ch atribut≈Ø z Unpaid Toll Transaction,</p></li>
<li><p>p≈ôevƒõs√≠ na Toll Transaction odpov√≠daj√≠c√≠ Rated Toll
Events,</p></li>
<li><p>updatuje atributy Toll Transaction:</p>
<ul>
<li><p>Unpaid Toll Transaction creation time = z Unpaid Toll
Transaction.creation time</p></li>
<li><p><mark>Payment = referenci na realizovanou platbu</mark></p></li>
</ul></li>
<li><p>zru≈°√≠ Unapid Toll Transaction.</p></li>
</ul>


<p>Syst√©m vygeneruje jednor√°zovou fakturu za m√Ωto za u≈æit√≠ syst√©mov√©
funkce Vytvo≈ô jednor√°zovou fakturu za m√Ωto (SYS.BAR.0.14.HR).</p>


<p>Syst√©m nap√°ruje novƒõ vytvo≈ôenou fakturu s platbou, tj. vytvo≈ô√≠ pro nƒõ
Matching s n√°sleduj√≠c√≠mi parametry:</p>


<ul>
<li><p>Date of matching = Datum a ƒças, kdy bylo p√°rov√°n√≠
provedeno</p></li>
<li><p>Effective date of matching = vy≈°≈°√≠ datum z datum≈Ø obou p√°rovan√Ωch
stran (tj. bill.date of end a payment.date of collection)</p></li>
<li><p>Bill ‚Äì debit matching side = Bill</p></li>
<li><p>Payment ‚Äì credit matching side = Payment</p></li>
<li><p>Matched amount = ƒç√°stka platby = ƒç√°stka faktury</p></li>
<li><p>Matching method = Automatic</p></li>
<li><p>Disconnect allowed = False</p></li>
<li><p>BO Oper√°tor = System</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Bill:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Bill.total
amount),</p></li>
<li><p>Bill payment status = Paid fully.</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Payment:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Payment
amount),</p></li>
<li><p>Matching status = Recognized ‚Äì matched.</p></li>
</ul>


<p>Syst√©m, pro ka≈æd√© zaplacen√© Offence RfP, kter√© je po splatnosti,
informuje Dunning, zavol√°n√≠m p≈ô√≠padu u≈æit√≠ Aktualizuj dluh
(SYS.DU.1.2.HR) s uveden√≠m Effective date of matching proveden√©ho
p√°rov√°n√≠.</p>


<p>Syst√©m na z√°kladƒõ zaplacen√Ωch P≈ôestupk≈Ø updatuje z√°znam Alert listu:
U existuj√≠c√≠ho z√°znamu Alert listu pro dan√© SPZ sn√≠≈æ√≠ ƒç√°stku Total due
amount o celkovou zaplacenou ƒç√°stku za m√Ωto (tj. o ƒç√°stku bez
administrativn√≠ch poplatk≈Ø) a sn√≠≈æ√≠ Offence count o poƒçet vy≈ôe≈°en√Ωch
m√Ωtn√Ωch transakc√≠, za pou≈æit√≠ syst√©mov√© funkce Zaeviduj Offence na Alert
list (SYS.TDP.5.6):</p>


<ul>
<li><p>UTT.Registration number a UTT.Registration country</p></li>
<li><p>Bill.Bill issuer</p></li>
<li><p>-1 * Suma Bill item.price amount VAT s¬†Bill item category = Toll
event (= suma Toll transaction.transaction amount VAT, u kter√Ωch se
mƒõnil stav na Processed)</p></li>
<li><p>-1 * Suma Bill item.number of units s¬†Bill item category = Toll
event (= poƒçet Toll transaction, u kter√Ωch se mƒõnil stav na
Processed)</p></li>
</ul>


<p>Syst√©m nab√≠dne na sta≈æen√≠ vygenerovanou fakturu.</p>


<p>Akt√©r Fakturu m≈Ø≈æe st√°hnout.</p>


<p>Syst√©m p≈ôegeneruje hlavn√≠ p≈ôehled zb√Ωvaj√≠c√≠ch P≈ôestupk≈Ø a V√Ωzev na
zaplacen√≠ per Bill issued a zobraz√≠ je Akt√©rovi.</p>


<p>Akt√©r m≈Ø≈æe prov√©st nov√Ω v√Ωbƒõr a pokraƒçovat platbou, nebo proces
ukonƒçit.</p>


<p>Pokud ji≈æ neexistuje ani jeden P≈ôestupek nebo V√Ωzva na √∫hradu, Syst√©m
zobraz√≠ informaci, ≈æe pro dan√© vozidlo ji≈æ neeviduje ≈æ√°dn√Ω
p≈ôestupek.</p>


<blockquote>
<p>Postup konƒç√≠.</p>
</blockquote>


<ol type="1">
<li><p>Alternativn√≠ postupy</p></li>
</ol>


<p>(A0) P≈ôestupek neexistuje</p>


<blockquote>
<p>Pokud pro SPZ nebo pro v≈°echny SPZ p≈ôihl√°≈°en√©ho z√°kazn√≠ka neexistuje
ani jedna V√Ωzva na √∫hradu, Syst√©m zobraz√≠ informaci, ≈æe moment√°lnƒõ
neeviduje ≈æ√°dn√Ω p≈ôestupek.</p>
</blockquote>


<p>(A1) Zapla≈• p≈ôestupek na POS, Kiosku nebo MEV</p>


<p>Akt√©r potvrd√≠ ƒç√°stku na zaplacen√≠ a postup pokraƒçuje realizac√≠ platby
za pou≈æit√≠ p≈ô√≠padu u≈æit√≠ Zapla≈• poplatek na POS (UC.BAR.0.3.HR).</p>


<p>(A2) Zapla≈• p≈ôestupek na Web Portal nebo Mobile app - online platba
p≈ôes platebn√≠ br√°nu</p>


<p>Placen√≠ z¬†Web port√°lu nebo Mobile App je pops√°no v¬†syst√©mov√© funkci
Zprocesuj transakci platebn√≠ kartou (API.BAR.0.1.HR):</p>


<ul>
<li><p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o vybran√Ωch p≈ôestupc√≠ch (UTTs nebo Offence RfPs) na
zaplacen√≠, Bill issuer a Account.</p></li>
<li><p>Syst√©m realizuje Online platbu p≈ôes CorvusPay platebn√≠ br√°nu za
pou≈æit√≠ syst√©mov√© funkce Zapla≈• ud√°lost online p≈ôes platebn√≠ br√°nu
(SYS.BAR.2.15.HR).</p></li>
<li></li>
<li><p>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, potvrd√≠ extern√≠mu
syst√©mu √∫spƒõ≈°nou realizaci platby a vr√°t√≠ identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p><mark>(A3) Zapla≈• p≈ôestupek na Web Portal nebo Mobile app ‚Äì jin√°
platebn√≠ metoda ne≈æ online platba p≈ôes platebn√≠ br√°nu</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o vybran√Ωch p≈ôestupc√≠ch (UTTs nebo Offence RfPs), typu
platebn√≠ metody (nap≈ô SMS, Voucher), Bill issuer a Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ Web portal API
(INT.BAR.33.HR).</mark></p>


<p><mark>(A4) Zapla≈• p≈ôestupek na extern√≠ POS</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ POS API (INT.BAR.34.HR) obdr≈æ√≠
informaci o vybran√Ωch p≈ôestupc√≠ch (UTTs nebo Offence RfPs), typu
platebn√≠ metody, Bill issuer a Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ POS API
(INT.BAR.34.HR).</mark></p>


<p>(A5) Zapla≈• p≈ôestupek bankovn√≠m p≈ôevodem na z√°kladƒõ Offence RfP</p>


<p>Syst√©m na vstupu p≈ôes Rozhran√≠ ERP Navision (INT.BAR.30.HR) obdr≈æ√≠
informaci o v√Ω≈°i platby, typ platebn√≠ metody (bank transfer), Offence
RfP, Bill issuer.</p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<ol type="1">
<li><p>Chybov√© postupy</p></li>
</ol>


<p>Ne√∫spƒõ≈°n√° transakce nebo zru≈°en√° transakce z√°kazn√≠kem</p>


<blockquote>
<p>Pokud transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status = Rejected
nebo Cancelled), Syst√©m informuje Akt√©ra o ne√∫spƒõ≈°n√© transakci.</p>
<p>Akt√©r m≈Ø≈æe pokraƒçovat √∫pravou poƒçtu vybran√Ωch polo≈æek na zaplacen√≠
nebo proces ukonƒçit.</p>
</blockquote>


<ol start="2" type="1">
<li><p>Grafick√© rozhran√≠</p></li>
</ol>


<blockquote>
<p>FO: UI.BAR.<mark>xxx</mark></p>
</blockquote>


<ol start="3" type="1">
<li><p>Pozn√°mky</p></li>
</ol>


<p>Po p≈ôihl√°≈°en√≠ do Offence port√°lu pomoc√≠ linku + PIN nebo registraƒçn√≠
znaƒçkou + PIN, bude mo≈æn√© se dodateƒçnƒõ anonymnƒõ zaregistrovat za pou≈æit√≠
p≈ô√≠padu u≈æit√≠ Zaregistruj vozidlo cez Offence Portal (UC.VCM.1.7.HR)</p>


<blockquote>
<p>Pokud placen√≠ p≈ôestupk≈Ø probƒõhlo p≈ôed registrac√≠, subjekt faktury
nebude vyplnƒõn. Pokud registrace probƒõhla p≈ôed placen√≠m p≈ôestupk≈Ø,
subjektem faktury bude novƒõ vytvo≈ôen√Ω Account.</p>
</blockquote>


<h3 id="zapla≈•-produktov√Ω-bal√≠ƒçek-uc.bar.0.21.hr">Zapla≈• Produktov√Ω
bal√≠ƒçek (UC.BAR.0.21.HR)</h3>


<h4 id="c√≠l-2">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu u≈æit√≠ je zaplacen√≠ Produktov√©ho bal√≠ƒçku.</p>


<h4 id="akt√©≈ôi-3">Akt√©≈ôi</h4>


<p>POS Operator, System, Customer</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu-2">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>P≈ô√≠pad u≈æit√≠ je vlo≈æenou souƒç√°st√≠ p≈ô√≠padu u≈æit√≠:</p>


<ul>
<li><p>Pridaj produktov√Ω bal√≠ƒçek (UC.VCM.1.6)</p></li>
<li></li>
</ul>


<p>Na z√°kladƒõ po≈æadavku na objedn√°n√≠ Produktu z rozhran√≠:</p>


<ul>
<li></li>
<li><p>Rozhran√≠ Web portal API (INT.BAR.33.HR)</p></li>
<li><p><mark>Rozhran√≠</mark> <mark>HR Toll</mark> <mark>API
(INT.BAR.34.HR)</mark></p></li>
<li><p><mark>Rozhran√≠ ERP Navision (INT.BAR.30.HR)</mark></p></li>
<li></li>
</ul>


<h4 id="podm√≠nky-spu≈°tƒõn√≠-2">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Customer je zn√°m a nen√≠ anonymn√≠ (tj. Anonymous registration =
false).</p>


<p>Product Account nebo Account je zn√°m.</p>


<p>Account nen√≠ terminovan√Ω.</p>


<p>Product package detail je zn√°m.</p>


<p>Bill issuer je zn√°m (tj. System operator).</p>


<p>Zp≈Øsob platby je zn√°m.</p>


<p>P≈ô√≠padnƒõ POS je zn√°ma.</p>


<h4 id="norm√°ln√≠-postup-2">Norm√°ln√≠ postup</h4>


<p>(N1) Zapla≈• produkt na vlastn√≠ POS, <mark>extern√≠ POS</mark></p>


<ul>
<li></li>
</ul>


<p>Syst√©m zobraz√≠ minim√°ln√≠ v√Ω≈°i top-up pro po≈æadovan√Ω Produktov√Ω
bal√≠ƒçek.</p>


<p>Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku minim√°ln√≠ho top-up.</p>


<p>Postup pokraƒçuje realizac√≠ platby top-up za pou≈æit√≠ p≈ô√≠padu u≈æit√≠
Zapla≈• poplatek na POS (UC.BAR.0.3.HR).</p>


<p>(N2) Zapla≈• produkt na Web Portal nebo Mobile app - online platba
p≈ôes platebn√≠ br√°nu</p>


<p>Placen√≠ z¬†Web port√°lu nebo Mobile App je pops√°no v¬†syst√©mov√© funkci
Zprocesuj transakci platebn√≠ kartou (API.BAR.0.1.HR):</p>


<ul>
<li><p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o Product package, v√Ω≈°i zadan√©ho produktov√©ho top-up,
Bill issuer a Account.</p></li>
<li><p>Syst√©m realizuje Online platbu p≈ôes CorvusPay platebn√≠ br√°nu za
pou≈æit√≠ syst√©mov√© funkce Zapla≈• ud√°lost online p≈ôes platebn√≠ br√°nu
(SYS.BAR.2.15.HR).</p></li>
<li><p>Pokud transakce byla √∫spƒõ≈°n√° (tj.Payment session.status =
Realized), proces pokraƒçuje Spoleƒçn√Ωm postupem.</p></li>
<li></li>
<li><p>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, potvrd√≠ extern√≠mu
syst√©mu √∫spƒõ≈°nou realizaci platby a vr√°t√≠ identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
<li></li>
</ul>


<p><mark>(N4) Zapla≈• produkt</mark> <mark>na extern√≠ POS</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ POS API (INT.BAR.34.HR) obdr≈æ√≠
informaci o v√Ω≈°i zaplacen√©ho Top-up, typ platebn√≠ metody, Bill issuer a
Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ POS API
(INT.BAR.34.HR).</mark></p>


<p>(N5) <mark>Zapla≈• produkt</mark> bankovn√≠m p≈ôevodem na z√°kladƒõ
Proforma faktury</p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ ERP Navision (INT.BAR.30.HR)
obdr≈æ√≠ informaci o v√Ω≈°i zaplacen√©ho Top-up, typ platebn√≠ metody (bank
transfer), Proforma bill, Bill issuer.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem a to krokem, kdy Syst√©m
nav√Ω≈°√≠ z≈Østatek p≈ôedplacen√©ho kreditu.</mark></p>


<p>Spoleƒçn√Ω postup pro v≈°echny platebn√≠ metody</p>


<p>Syst√©m vytvo≈ô√≠ nov√Ω Product account (pokud Account ze vstupu byl
n√°rodn√≠ Account a dan√Ω Product account na z√°kazn√≠kovi je≈°tƒõ neexistuje)
nebo updatuje existuj√≠c√≠ Product account (pokud Account na vstupu byl
Product account) za pou≈æit√≠ p≈ô√≠padu u≈æit√≠ (Pridaj produktov√Ω bal√≠ƒçek
(UC.VCM.1.6)).</p>


<p>Syst√©m vytvo≈ô√≠ Product balance, pokud je≈°tƒõ neexistuje pro dan√Ω
Product Account, za pou≈æit√≠ syst√©mov√© funkce Vytvo≈ô z≈Østatky
(SYS.BM.1.3.HR).</p>


<p>Syst√©m o ƒç√°stku platby nav√Ω≈°√≠ z≈Østatek odpov√≠daj√≠c√≠ Product balance,
pou≈æije se p≈ô√≠pad u≈æit√≠ Aktualizuj z≈Østatek (SYS.BM.1.2) s Product
account number.</p>


<p>Syst√©m zjist√≠ √∫daje o Product package eventƒõ na z√°kladƒõ Bill issuer,
Product type = Product package a Event attribute Product package =
Product package ze vstupu, za pou≈æit√≠ p≈ô√≠padu u≈æit√≠ Z√≠skej produkt
(SYS.PCRE.1.2.HR).</p>


<p>Syst√©m vygeneruje jednor√°zovou fakturu za slu≈æby za u≈æit√≠ syst√©mov√©
funkce Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p>


<p>Syst√©m nap√°ruje novƒõ vytvo≈ôen√Ω Bill na novƒõ vytvo≈ôen√Ω Payment, tj.
vytvo≈ô√≠ Matching s¬†n√°sleduj√≠c√≠mi parametry:</p>


<ul>
<li><p>Date of matching = aktu√°ln√≠ datum</p></li>
<li><p>Effective date of matching = vy≈°≈°√≠ z¬†datum≈Ø p√°rovan√Ωch stran (tj.
payment.date of collection, bill.date od end)</p></li>
<li><p>Bill ‚Äì debit matching side = vytvo≈ôen√Ω Bill</p></li>
<li><p>Payment ‚Äì credit matching side = vytvo≈ôen√Ω Payment</p></li>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up</p></li>
<li><p>Matching method = Automatic</p></li>
<li><p>Disconnect allowed = True</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Bill:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Bill.total
amount),</p></li>
<li><p>Bill payment status = Paid fully.</p></li>
</ul>


<p>Syst√©m na z√°kladƒõ proved√©ho p√°rov√°n√≠ updatuje atributy nap√°rovan√©ho
Payment:</p>


<ul>
<li><p>Matched amount = ƒç√°stka zaplacen√©ho top-up (tj. Payment
amount),</p></li>
<li><p>Matching status = Recognized ‚Äì matched.</p></li>
</ul>


<p><mark>Pokud ≈°lo o platbu tankovac√≠ kartou, Syst√©m zagreguje platbu do
odpov√≠daj√≠c√≠ho FCI RfP, vyu≈æit√≠m p≈ô√≠padu u≈æit√≠ Zagreguj platby tankovac√≠
kartou do FCI RfP (SYS.BAR.0.9).</mark></p>


<p>Postup konƒç√≠.</p>


<h4 id="alternativn√≠-postupy-2">Alternativn√≠ postupy </h4>


<p><mark>(A1) Bez platby ‚Äì Proforma (na BO, vlastn√≠ POS, extern√≠ POS
nebo MEV )</mark></p>


<p><mark>Pokud Akt√©r bude cht√≠t jako platebn√≠ metodu bankovn√≠ p≈ôevod,
iniciuje vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)) zm√°ƒçknut√≠m
p≈ô√≠slu≈°n√©ho tlaƒç√≠tka a spu≈°tƒõn√≠m p≈ô√≠padu u≈æit√≠ Vytvo≈ô proforma fakturu
(UC.BAR.3.3.HR).</mark></p>


<p><mark>Postup konƒç√≠.</mark></p>


<p><mark>(A2) Bez platby</mark> <mark>‚Äì Proforma (Web portal nebo Mobile
app)</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o v√Ω≈°i po≈æadovan√©ho</mark> <mark>Produktov√©ho top-up,
Product package,</mark> <mark>Bill issuer a Account, tzn. ≈æe z√°kazn√≠k m√°
z√°jem o vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)), kterou chce
zaplatit bankovn√≠m p≈ôevodem. Operace je realizov√°na za pou≈æit√≠ syst√©mov√©
funkce Vygeneruj proforma fakturu (API.BAR.1.1.HR)</mark></p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p>Postup konƒç√≠.</p>


<h4 id="chybov√©-postupy-2">Chybov√© postupy</h4>


<p>Ne√∫spƒõ≈°n√° online transakce</p>


<blockquote>
<p>Pokud online transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status =
Rejected), Syst√©m informuje Akt√©ra o ne√∫spƒõ≈°n√© transakci (pokud proces
byl inicializov√°n v¬†r√°mci Syst√©mu) a Akt√©r m≈Ø≈æe pokraƒçovat od zaƒç√°tku
√∫pravou v√Ω≈°e Top-up nebo proces ukonƒçit.</p>
<p>P≈ô√≠padnƒõ Syst√©m vr√°t√≠ odpov√≠daj√≠c√≠ result extern√≠mu syst√©mu (pokud
proces byl inicializov√°n z¬†extern√≠ho syst√©mu).</p>
</blockquote>


<h4 id="grafick√©-rozhran√≠-2">Grafick√© rozhran√≠</h4>


<p>N/A</p>


<h4 id="pozn√°mky-1">Pozn√°mky</h4>


<p>Nejsou</p>


<h3 id="zapla≈•-obu-uc.bar.0.22.hr">Zapla≈• OBU (UC.BAR.0.22.HR)</h3>


<h4 id="c√≠l-3">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu u≈æit√≠ je nav√Ω≈°en√≠ OBU balance p≈ôed samotn√Ωm
v√Ωdejem OBU.</p>


<h4 id="akt√©≈ôi-4">Akt√©≈ôi</h4>


<p>POS Operator, System, Customer</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu-3">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>P≈ô√≠pad u≈æit√≠ je vlo≈æenou souƒç√°st√≠ p≈ô√≠padu u≈æit√≠:</p>


<ul>
<li><p>Objednaj OBU (UC.VCM.2.8) (jen Proforma)</p></li>
<li><p>Vydaj OBU na POS (UC.VCM.2.9)</p></li>
</ul>


<p>Na z√°kladƒõ po≈æadavku na Top-up z rozhran√≠:</p>


<ul>
<li><p>Rozhran√≠ ERP Navision (INT.BAR.30.HR)</p></li>
<li><p>Rozhran√≠ Web portal API (INT.BAR.33.HR)</p></li>
<li><p><mark>Rozhran√≠ intern√≠ POS API (INT.BAR.34.HR)</mark></p></li>
<li><p>Rozhran√≠ intern√≠ IEFBO API (INT.BAR.36.HR)</p></li>
</ul>


<ul>
<li></li>
</ul>


<h4 id="podm√≠nky-spu≈°tƒõn√≠-3">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Account je zn√°m.</p>


<p><mark>Account nen√≠ terminovan√Ω.</mark></p>


<p>Poƒçet po≈æadovan√Ωch OBU je zn√°m.</p>


<p>Cena za jednu OBU je zn√°ma.</p>


<p>Bill issuer je zn√°m (tj. System operator).</p>


<p>Zp≈Øsob platby je zn√°m.</p>


<p>P≈ô√≠padnƒõ POS je zn√°ma.</p>


<h4 id="norm√°ln√≠-postup-3">Norm√°ln√≠ postup</h4>


<p>(N1) Zapla≈• OBU na vlastn√≠ POS, extern√≠ POS nebo MEV</p>


<p>Syst√©m zobraz√≠ aktu√°ln√≠ v√Ω≈°i OBU balance poplatnou Toll chargerovi
dan√© POS.</p>


<p>Akt√©r vypln√≠ po≈æadovan√Ω poƒçet palubn√≠ch jednotek.</p>


<p>Syst√©m, na z√°kladƒõ zadan√©ho poƒçtu OBE, aktu√°ln√≠ v√Ω≈°e OBU balance a
ceny za OBU dan√©ho TC, spoƒç√≠t√° minim√°ln√≠ pot≈ôebnou ƒç√°stku k¬†√∫hradƒõ:</p>


<ul>
<li><p>Pokud ƒç√°stka OBU balance je dostateƒçn√° na po≈æadovan√Ω poƒçet OBU,
postup je ukonƒçen.</p></li>
<li><p>Jinak Syst√©m zobraz√≠ minim√°ln√≠ ƒç√°stku k √∫hradƒõ.</p></li>
</ul>


<p>Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku.</p>


<p>Postup pokraƒçuje realizac√≠ platby OBU za pou≈æit√≠ p≈ô√≠padu u≈æit√≠ Zapla≈•
poplatek na POS (UC.BAR.0.3.HR).</p>


<p>(N2) Zapla≈• OBU na Web Portal nebo Mobile app - online platba p≈ôes
platebn√≠ br√°nu</p>


<p>Placen√≠ z¬†Web port√°lu nebo Mobile App je pops√°no v¬†syst√©mov√© funkci
Zprocesuj transakci platebn√≠ kartou (API.BAR.0.1.HR):</p>


<ul>
<li><p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o poƒçtu OBU, Bill issuer a Account.</p></li>
<li><p>Syst√©m realizuje Online platbu p≈ôes CorvusPay platebn√≠ br√°nu za
pou≈æit√≠ syst√©mov√© funkce Zapla≈• ud√°lost online p≈ôes platebn√≠ br√°nu
(SYS.BAR.2.15.HR).</p></li>
<li><p>Pokud transakce byla √∫spƒõ≈°n√° (tj.Payment session.status =
Realized), proces pokraƒçuje Spoleƒçn√Ωm postupem.</p></li>
<li><p>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, potvrd√≠ extern√≠mu
syst√©mu √∫spƒõ≈°nou realizaci platby a vr√°t√≠ identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p><mark>(N4)</mark> <mark>Zapla≈• OBU</mark> <mark>p≈ôes HR Toll
aplikaci</mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ HR Toll API (INT.BAR.34.HR)
obdr≈æ√≠ informaci o v√Ω≈°i zaplacen√©ho Top-up, typ platebn√≠ metody, Bill
issuer a Account.</mark></p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p><mark>Proces pokraƒçuje Spoleƒçn√Ωm postupem.</mark></p>


<p><mark>Syst√©m, nav√≠c oproti Spoleƒçn√©mu postupu, vr√°t√≠ extern√≠mu
syst√©mu identifikaci vytvo≈ôen√© faktury p≈ôes Rozhran√≠ POS API
(INT.BAR.34.HR).</mark></p>


<p>(N5) Zapla≈• OBU bankovn√≠m p≈ôevodem na z√°kladƒõ Proforma faktury</p>


<p>Syst√©m na vstupu p≈ôes Rozhran√≠ ERP Navision (INT.BAR.30.HR) obdr≈æ√≠
informaci o v√Ω≈°i platby za OBU, typ platebn√≠ metody (bank transfer),
Proforma bill, Bill issuer.</p>


<p><mark>Syst√©m vytvo≈ô√≠ odpov√≠daj√≠c√≠ realizovanou platbu za pou≈æit√≠
syst√©mov√© funkce Zapla≈• ud√°lost platbou z¬†extern√≠ho syst√©mu
(SYS.BAR.2.16.HR).</mark></p>


<p>Proces pokraƒçuje Spoleƒçn√Ωm postupem.</p>


<p>Spoleƒçn√Ω postup pro v≈°echny platebn√≠ metody</p>


<p>Syst√©m o ƒç√°stku platby nav√Ω≈°√≠ z≈Østatek OBU balance dan√©ho Toll
chargera.</p>


<p><mark>Pokud ≈°lo o platbu tankovac√≠ kartou, Syst√©m zagreguje platbu do
odpov√≠daj√≠c√≠ho FCI RfP, vyu≈æit√≠m p≈ô√≠padu u≈æit√≠ Zagreguj platby tankovac√≠
kartou do FCI RfP (SYS.BAR.0.9).</mark></p>


<p>Postup konƒç√≠.</p>


<h4 id="alternativn√≠-postupy-3">Alternativn√≠ postupy </h4>


<p>(A1) Bez platby ‚Äì Proforma (na BO, vlastn√≠ POS, extern√≠ POS nebo MEV
)</p>


<p>Pokud Akt√©r bude cht√≠t jako platebn√≠ metodu bankovn√≠ p≈ôevod, iniciuje
vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)) zm√°ƒçknut√≠m p≈ô√≠slu≈°n√©ho
tlaƒç√≠tka a spu≈°tƒõn√≠m p≈ô√≠padu u≈æit√≠ Vytvo≈ô proforma fakturu
(UC.BAR.3.3.HR).</p>


<p>Postup konƒç√≠.</p>


<p>(A2) Bez platby ‚Äì Proforma (Web portal nebo Mobile app)</p>


<p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR) obdr≈æ√≠
informaci o poƒçtu po≈æadovan√Ωch OBU, Bill issuer a Account, tzn. ≈æe
z√°kazn√≠k m√° z√°jem o vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)),
kterou chce zaplatit bankovn√≠m p≈ôevodem.</p>


<p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce Vytvo≈ô
jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR). Operace je realizov√°na
za pou≈æit√≠ syst√©mov√© funkce Vygeneruj proforma fakturu
(API.BAR.1.1.HR):</p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p>Postup konƒç√≠.</p>


<h4 id="chybov√©-postupy-3">Chybov√© postupy</h4>


<p>Ne√∫spƒõ≈°n√° transakce</p>


<blockquote>
<p>Pokud transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status =
Rejected), Syst√©m informuje Akt√©ra o ne√∫spƒõ≈°n√© transakci (pokud proces
byl inicializov√°n v¬†r√°mci Syst√©mu) a Akt√©r m≈Ø≈æe pokraƒçovat od zaƒç√°tku
√∫pravou poƒçtu OBU nebo proces ukonƒçit.</p>
</blockquote>


<p>Ne√∫spƒõ≈°n√° online transakce</p>


<blockquote>
<p>Pokud transakce nebyla √∫spƒõ≈°n√° (tj.Payment session.status =
Rejected), Syst√©m vr√°t√≠ odpov√≠daj√≠c√≠ result extern√≠mu syst√©mu (pokud
proces byl inicializov√°n z¬†extern√≠ho syst√©mu).</p>
</blockquote>


<h4 id="grafick√©-rozhran√≠-3">Grafick√© rozhran√≠</h4>


<p>N/A</p>


<h4 id="pozn√°mky-2">Pozn√°mky</h4>


<p>Nejsou</p>


<h2 id="operace-s-fakturami">Operace s fakturami</h2>


<h3 id="vytvo≈ô-proforma-fakturu-uc.bar.3.3.hr">Vytvo≈ô proforma fakturu
(UC.BAR.3.3.HR)</h3>


<h4 id="c√≠l-4">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu pou≈æit√≠ je vytvo≈ôit proforma fakturu pro prodej
Top-up, OBU nebo Produktov√©ho bal√≠ƒçku. Jde o vystaven√≠ nab√≠dky, kterou
bude moci z√°kazn√≠k uhradit bankovn√≠m p≈ôevodem.</p>


<h4 id="akt√©≈ôi-5">Akt√©≈ôi</h4>


<p>POS Operator, BO Operator, System, Customer</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu-4">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>P≈ô√≠pad u≈æit√≠ je vlo≈æenou souƒç√°st√≠ p≈ô√≠padu u≈æit√≠:</p>


<ul>
<li><p>Zapla≈• p≈ôedplacen√Ω kredit ‚Äì Pre-paid in single domain
(UC.BAR.0.1.HR)</p>
<ul>
<li><p>na BO, POS, <mark>extern√≠ POS</mark> nebo MEV</p></li>
</ul></li>
<li><p>Zapla≈• OBU (UC.BAR.0.22.HR), Objednaj OBU (UC.VCM.2.8)</p>
<ul>
<li><p>na BO, POS, <mark>extern√≠ POS</mark> nebo MEV</p></li>
</ul></li>
<li><p>Zapla≈• Produktov√Ω bal√≠ƒçek (UC.BAR.0.21.HR), Pridaj produktov√Ω
bal√≠ƒçek (UC.VCM.1.6)</p>
<ul>
<li><p><mark>na</mark> <mark>BO,</mark> <mark>POS, extern√≠ POS,</mark>
<mark><br/>
</mark></p></li>
</ul></li>
</ul>


<p>Na z√°kladƒõ po≈æadavku na Proforma fakturu z rozhran√≠:</p>


<ul>
<li><p>Rozhran√≠ Web portal API (INT.BAR.33.HR) - Vygeneruj proforma
fakturu (API.BAR.1.1.HR)</p></li>
<li><p>Rozhran√≠ intern√≠ IEFBO API (INT.BAR.36.HR)</p></li>
</ul>


<h4 id="podm√≠nky-spu≈°tƒõn√≠-4">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Account je zn√°m.</p>


<p><mark>Account nen√≠ terminovan√Ω.</mark></p>


<p>Pro spu≈°tƒõn√≠ UC z rozhran√≠: Je zn√°ma ƒç√°stka k √∫hradƒõ, typ operace
(OBU, Top-up, Product package), p≈ô√≠padnƒõ poƒçet OBU, p≈ô√≠padnƒõ identifiace
Product package.</p>


<p>Bill issuer je zn√°m (tj. System operator).</p>


<p>P≈ô√≠padnƒõ POS je zn√°ma.</p>


<h4 id="norm√°ln√≠-postup-4">Norm√°ln√≠ postup</h4>


<p><u>(N1) Proforma na Top-up na BO, vlastn√≠ POS, <mark>extern√≠
POS</mark> nebo MEV</u></p>


<p>Syst√©m zobraz√≠ <strong>aktu√°ln√≠ v√Ω≈°i balance</strong>
(BM.Balance.amount - BM.Balance.Reservation amount - Grace period
amount).</p>


<p>Syst√©m zobraz√≠ minim√°ln√≠ zaokrouhlenou v√Ω≈°i kreditu k zaplacen√≠:</p>


<ul>
<li><p>Pokud <strong>aktu√°ln√≠ v√Ω≈°e balance</strong> &lt; 0, pak MAX
(absolutn√≠ hodnota aktu√°ln√≠ v√Ω≈°e balance; BAR.Currency.Minimum top-up
amount),</p></li>
<li><p>jinak BAR.Currency.Minimum top-up amount.</p></li>
</ul>


<p>Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku minim√°ln√≠ho top-up.</p>


<p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce Vytvo≈ô
jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p>


<p><mark>(N2) Proforma na</mark> <mark>Produktov√Ω nbal√≠ƒçek</mark>
<mark>na BO, vlastn√≠ POS, extern√≠ POS nebo MEV</mark></p>


<p><mark>Syst√©m zobraz√≠</mark> <mark>minim√°ln√≠ v√Ω≈°i top-up dan√©ho
Produktov√©ho bal√≠ƒçku.</mark></p>


<p><mark>Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku.</mark></p>


<p><mark>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</mark></p>


<p>(N3) Proforma na OBU na BO, vlastn√≠ POS, extern√≠ POS nebo MEV</p>


<p>Syst√©m zobraz√≠ aktu√°ln√≠ v√Ω≈°i OBU balance poplatnou Toll chargerovi
dan√© POS.</p>


<p>Akt√©r vypln√≠ po≈æadovan√Ω poƒçet palubn√≠ch jednotek.</p>


<p>Syst√©m, na z√°kladƒõ zadan√©ho poƒçtu OBE, aktu√°ln√≠ v√Ω≈°e OBU balance a
ceny za OBU dan√©ho TC, spoƒç√≠t√° pot≈ôebnou minim√°ln√≠ ƒç√°stku k¬†√∫hradƒõ:</p>


<ul>
<li><p>Pokud ƒç√°stka OBU balance je dostateƒçn√° na po≈æadovan√Ω poƒçet OBU,
postup je ukonƒçen.</p></li>
<li><p>Jinak Syst√©m zobraz√≠ minim√°ln√≠ ƒç√°stku k √∫hradƒõ.</p></li>
</ul>


<p>Akt√©r zv√Ω≈°√≠ nebo potvrd√≠ ƒç√°stku.</p>


<p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce Vytvo≈ô
jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p>


<p>Postup konƒç√≠.</p>


<h4 id="alternativn√≠-postupy-4">Alternativn√≠ postupy </h4>


<p><u>(A1) Proforma na Top-up (Web portal nebo Mobile app)</u></p>


<p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR) obdr≈æ√≠
informaci o v√Ω≈°i po≈æadovan√©ho Top-up, Bill issuer a Account, tzn. ≈æe
z√°kazn√≠k m√° z√°jem o vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)),
kterou chce zaplatit bankovn√≠m p≈ôevodem. Operace je realizov√°na za
pou≈æit√≠ syst√©mov√© funkce Vygeneruj proforma fakturu
(API.BAR.1.1.HR):</p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p><mark><u>(A2) Proforma na</u></mark> <mark><u>Produktov√Ω
bal√≠ƒçek</u></mark> <mark><u>(Web portal nebo Mobile app)</u></mark></p>


<p><mark>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR)
obdr≈æ√≠ informaci o v√Ω≈°i po≈æadovan√©ho Produktov√©ho top-up, Product
package, Bill issuer a Account, tzn. ≈æe z√°kazn√≠k m√° z√°jem o vytvo≈ôen√≠
nab√≠dky (tj. Proforma faktury (Offer)), kterou chce zaplatit bankovn√≠m
p≈ôevodem. Operace je realizov√°na za pou≈æit√≠ syst√©mov√© funkce Vygeneruj
proforma fakturu (API.BAR.1.1.HR):</mark></p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<p>(A3) Proforma na OBU (Web portal nebo Mobile app)</p>


<p>Syst√©m na vstupu p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR) obdr≈æ√≠
informaci o poƒçtu po≈æadovan√Ωch OBU, Bill issuer a Account, tzn. ≈æe
z√°kazn√≠k m√° z√°jem o vytvo≈ôen√≠ nab√≠dky (tj. Proforma faktury (Offer)),
kterou chce zaplatit bankovn√≠m p≈ôevodem. Operace je realizov√°na za
pou≈æit√≠ syst√©mov√© funkce Vygeneruj proforma fakturu
(API.BAR.1.1.HR):</p>


<ul>
<li><p>Syst√©m vygeneruje Proforma fakturu za pou≈æit√≠ syst√©mov√© funkce
Vytvo≈ô jednor√°zovou fakturu za slu≈æby (SYS.BAR.0.4.HR).</p></li>
<li><p>Syst√©m vr√°t√≠ extern√≠mu syst√©mu identifikaci vytvo≈ôen√© faktury
p≈ôes Rozhran√≠ Web portal API (INT.BAR.33.HR).</p></li>
</ul>


<h4 id="chybov√©-postupy-4">Chybov√© postupy</h4>


<blockquote>
<p>Nejsou</p>
</blockquote>


<h4 id="grafick√©-rozhran√≠-4">Grafick√© rozhran√≠</h4>


<p><mark>TBD</mark></p>


<h4 id="pozn√°mky-3">Pozn√°mky</h4>


<p>Nejsou</p>


<h3 id="vytvo≈ô-korekci-uc.bar.3.x.hr">Vytvo≈ô korekci
(<mark>UC.BAR.3.X.HR</mark>)</h3>


<h4 id="c√≠l-5">C√≠l</h4>


<p>C√≠lem tohoto p≈ô√≠padu pou≈æit√≠ je vytvo≈ôit manu√°ln√≠ kreditn√≠ korekci
faktury za slu≈æby, ƒçi smluvn√≠ pokuty. Vƒçetnƒõ tohoto p≈ô√≠padu u≈æit√≠ je i
vr√°cen√≠ OBU jednotky do 15 dn√≠ a p≈ô√≠slu≈°enstv√≠ k OBU.</p>


<h4 id="akt√©≈ôi-6">Akt√©≈ôi</h4>


<p>BO Operator</p>


<h4 id="spu≈°tƒõn√≠-p≈ô√≠padu-5">Spu≈°tƒõn√≠ p≈ô√≠padu</h4>


<p>Tlaƒç√≠tkem z¬†BAR BO v¬†p≈ô√≠padƒõ korekce slu≈æby.</p>


<p>V¬†p≈ô√≠padƒõ vr√°cen√≠ OBU ƒçi OBU p≈ô√≠slu≈°enstv√≠, p≈ô√≠jmem zbo≈æ√≠ a
kontrolou, do 15 dn√≠ na POS, ƒçi zasl√°n√≠ po≈°tou.</p>


<h4 id="podm√≠nky-spu≈°tƒõn√≠-5">Podm√≠nky spu≈°tƒõn√≠</h4>


<p>Existuje faktura za slu≈æby, nebo smluvn√≠ pokuty (tj. Faktura m√°
kategorii Services nebo <mark>Penalty</mark>, Offence (RSE), OBU
accesories), kter√° nen√≠ korigov√°na (nemus√≠ b√Ωt Issued)</p>


<p>√öƒçet nen√≠ Terminated</p>


<p>Faktura m√° issue type: Regular bill</p>


<p>Faktura nebyla plnƒõ korigov√°na (tj. Existuje na faktu≈ôe alespo≈à jeden
RSE, kter√Ω je Cancellable = true a Number of units corrected &lt; Number
of units).</p>


<h4 id="norm√°ln√≠-postup-5">Norm√°ln√≠ postup</h4>


<p>V¬†p≈ô√≠padƒõ manu√°ln√≠ korekce v¬†BAR BO:</p>


<p>Akt√©r vyhled√° fakturu, kter√° m√° b√Ωt korigov√°na a iniciuje vytvo≈ôen√≠
kreditn√≠ korekce (tlaƒç√≠tkem na BO).</p>


<p>Syst√©m zobraz√≠ p≈ôehled v≈°ech Bill item (agregovan√Ωch), jeho≈æ RSE se
daj√≠ zru≈°it (Tj. RSE. Cancellable = true), a pro ka≈ædou z nich zobraz√≠
celkov√Ω poƒçet jednotek, poƒçet jednotek, kter√© lze korigovat (suma Number
of units agregovan√Ωch RSE - suma Number of units corrected agregovan√Ωch
RSE), jednotkovou cenu a jej√≠ mƒõnu. Z√°rove≈à zobraz√≠ ty, kter√© ji≈æ jsou
korigov√°ny (jsou za≈°edl√©).</p>


<h4 id="alternativn√≠-postupy-5">Alternativn√≠ postupy </h4>


<p><u>Korekce cel√© faktury</u></p>


<h4 id="chybov√©-postupy-5">Chybov√© postupy</h4>


<h4 id="grafick√©-rozhran√≠-5">Grafick√© rozhran√≠</h4>


<h4 id="pozn√°mky-4">Pozn√°mky</h4>


        </main>

        <!-- Right Sidebar - Modern Minimap -->
        <aside class="minimap" id="minimap">
            <div class="minimap-header">
                <h4>Overview</h4>
            </div>
            <div class="minimap-content">
                <div class="minimap-viewport" id="minimapViewport"></div>
                <div class="change-indicator" id="changeIndicator" style="display: none;">
                    <!-- Change marks will be populated by JavaScript -->
                </div>
            </div>
        </aside>
    </div>
    
    <script>
        // Document metadata
        const documentMetadata = {
            baseName: "HR_FS_Billing_Accounts_Receivables_CZ",
            displayName: "Hr Fs Billing Accounts Receivables Cz",
            version: "v00_03_2025_08_26",
            sectionNumber: 7,
            sectionTitle: "P≈ô√≠pady u≈æit√≠"
        };
        
        let originalContent = document.getElementById('mainContent').outerHTML;
        let comparisonContent = null;
        
        // Test diff library on load
        function initializeDiff() {
            if (typeof Diff === 'undefined') {
                console.error('Diff library failed to load from CDN');
                const warningDiv = document.createElement('div');
                warningDiv.style.cssText = 'background: #fff3cd; color: #856404; padding: 10px; margin: 10px 0; border: 1px solid #ffeaa7; border-radius: 4px;';
                warningDiv.innerHTML = '‚ö†Ô∏è Diff comparison library failed to load. The "Show changes" feature may not work properly.';
                document.querySelector('.version-bar').appendChild(warningDiv);
                return false;
            }
            console.log('Diff library loaded successfully');
            return true;
        }
        
        // Initialize on page load
        window.addEventListener('load', function() {
            initializeTheme();
            initializeDiff();
            initializeVersionControls();
            initializeNavigation();
            initializeScrollBehavior();
        });
        
        function initializeVersionControls() {
            console.log('Initializing version controls');
            const versionSelect = document.getElementById('versionSelect');
            const showChangesCheckbox = document.getElementById('showChanges');
            
            // Detect if running standalone (file:// protocol)
            const isStandalone = window.location.protocol === 'file:';
            const availableVersions = versionSelect.options.length;
            
            console.log('Protocol:', window.location.protocol);
            console.log('Is standalone:', isStandalone);
            console.log('Available versions:', availableVersions);
            
            if (isStandalone) {
                // Running standalone - disable comparison features
                console.log('Standalone mode detected, disabling comparison features');
                versionSelect.disabled = true;
                showChangesCheckbox.disabled = true;
                showChangesCheckbox.checked = false;
                
                // Add standalone notice
                const notice = document.createElement('div');
                notice.style.cssText = 'background: #e3f2fd; color: #1565c0; padding: 8px 12px; margin: 0 1rem; border-radius: 4px; font-size: 0.8rem;';
                notice.innerHTML = 'üìÑ Standalone mode - Version comparison disabled';
                document.querySelector('.top-bar .controls').appendChild(notice);
                
                // Hide version controls
                versionSelect.parentElement.style.display = 'none';
                showChangesCheckbox.parentElement.style.display = 'none';
            } else if (availableVersions === 0) {
                // Server mode but no versions to compare with - disable controls
                console.log('No comparison versions available, disabling controls');
                versionSelect.disabled = true;
                showChangesCheckbox.disabled = true;
                showChangesCheckbox.checked = false;
            } else {
                // At least one version available for comparison - enable controls
                console.log('Comparison versions available, enabling controls');
                versionSelect.disabled = false;
                showChangesCheckbox.disabled = false;
                showChangesCheckbox.checked = false; // Start unchecked
                
                // Pre-load the selected version for comparison
                loadVersionForComparison();
            }
        }
        
        function toggleDiff() {
            console.log('toggleDiff() called');
            const showChanges = document.getElementById('showChanges').checked;
            console.log('showChanges checkbox value:', showChanges);
            const contentDiv = document.getElementById('mainContent');
            console.log('comparisonContent exists:', !!comparisonContent);
            
            if (showChanges && comparisonContent) {
                console.log('Showing diff view');
                showDiffView(originalContent, comparisonContent);
                // Create change indicators after showing diff
                setTimeout(createChangeIndicators, 100);
            } else {
                console.log('Showing original content');
                contentDiv.innerHTML = originalContent;
                // Hide change indicators
                document.getElementById('changeIndicator').style.display = 'none';
            }
        }
        
        function loadVersionForComparison() {
            console.log('loadVersionForComparison() called');
            const selectedVersion = document.getElementById('versionSelect').value;
            console.log('Selected version:', selectedVersion);
            console.log('Current version:', documentMetadata.version);
            if (selectedVersion === documentMetadata.version) {
                console.log('Same version selected, clearing comparison');
                comparisonContent = null;
                toggleDiff();
                return;
            }
            
            // Generate the correct filename using the same sanitization logic as the backend
            function sanitizeFilename(text) {
                return text
                    .replace(/<[^>]+>/g, '') // Remove HTML tags
                    .replace(/[^\p{L}\p{N}\s\-_]/gu, '') // Remove non-letters/numbers but preserve Unicode letters
                    .replace(/[\s_]+/g, '_') // Replace spaces/underscores with single underscore
                    .toLowerCase()
                    .substring(0, 50) // Limit length
                    .replace(/^_+|_+$/g, ''); // Remove leading/trailing underscores
            }
            
            const sanitizedTitle = sanitizeFilename(documentMetadata.sectionTitle);
            const comparisonPath = `../${selectedVersion}/${documentMetadata.baseName}_${String(documentMetadata.sectionNumber).padStart(2, '0')}_${sanitizedTitle}.html`;
            
            console.log('Attempting to load:', comparisonPath);
            
            fetch(comparisonPath)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.text();
                })
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const content = doc.getElementById('mainContent');
                    if (content) {
                        comparisonContent = content.outerHTML;
                        console.log('Comparison content loaded successfully');
                        toggleDiff();
                    } else {
                        console.error('No mainContent found in comparison file');
                        comparisonContent = null;
                    }
                })
                .catch(error => {
                    console.error('Error loading comparison version:', error);
                    console.error('Attempted path was:', comparisonPath);
                    comparisonContent = null;
                    
                    // Show user-friendly error
                    const errorMsg = `Could not load comparison version: ${error.message}\n\nPath: ${comparisonPath}\n\nNote: Make sure you're opening the HTML file directly in your browser, not through a web server.`;
                    alert(errorMsg);
                });
        }
        
        function showDiffView(original, comparison) {
            if (!comparison) return;
            
            const contentDiv = document.getElementById('mainContent');
            
            if (typeof Diff !== 'undefined') {
                console.log('Creating comprehensive diff view');
                try {
                    // First, show the original content
                    contentDiv.innerHTML = original;
                    
                    // Create temporary elements to parse the HTML
                    const tempOriginal = document.createElement('div');
                    const tempComparison = document.createElement('div');
                    tempOriginal.innerHTML = original;
                    tempComparison.innerHTML = comparison;
                    
                    // Apply table-specific highlighting
                    const originalRows = Array.from(tempOriginal.querySelectorAll('tbody tr'));
                    const comparisonRows = Array.from(tempComparison.querySelectorAll('tbody tr'));
                    
                    if (originalRows.length > 0 || comparisonRows.length > 0) {
                        console.log(`Comparing ${originalRows.length} vs ${comparisonRows.length} table rows`);
                        
                        if (originalRows.length !== comparisonRows.length) {
                            highlightTableDifferences(original, comparison, contentDiv);
                        } else {
                            highlightCellDifferences(originalRows, comparisonRows, contentDiv, original);
                        }
                    }
                    
                    // Apply line-by-line text highlighting
                    highlightTextDifferences(tempOriginal, tempComparison, contentDiv);
                    
                } catch (error) {
                    console.error('Error creating diff:', error);
                    contentDiv.innerHTML = original;
                }
            } else {
                console.warn('Diff library not loaded, using original content');
                contentDiv.innerHTML = original;
            }
        }
        
        function highlightTextDifferences(originalElement, comparisonElement, contentDiv) {
            console.log('Applying line-by-line text highlighting');
            
            // Only compare actual document content, not template elements  
            // Now that we preserve outerHTML, we can use the specific selector
            const contentSelector = '#mainContent p, #mainContent li, #mainContent h1, #mainContent h2, #mainContent h3, #mainContent h4, #mainContent h5, #mainContent h6, #mainContent blockquote';
            
            // Get text-containing elements from document content only
            const originalTextElements = originalElement.querySelectorAll(contentSelector);
            const comparisonTextElements = comparisonElement.querySelectorAll(contentSelector);
            
            console.log(`Comparing ${originalTextElements.length} original elements vs ${comparisonTextElements.length} comparison elements`);
            
            // Create maps for comparison
            const originalTexts = Array.from(originalTextElements).map(el => el.textContent.trim()).filter(text => text.length > 0);
            const comparisonTexts = Array.from(comparisonTextElements).map(el => el.textContent.trim()).filter(text => text.length > 0);
            
            console.log(`Filtered to ${originalTexts.length} original texts vs ${comparisonTexts.length} comparison texts`);
            
            // Find corresponding elements in the rendered content
            const renderedElements = contentDiv.querySelectorAll(contentSelector);
            
            let changeCount = { added: 0, modified: 0, removed: 0 };
            
            // Create a more sophisticated comparison
            const originalSet = new Set(originalTexts);
            const comparisonSet = new Set(comparisonTexts);
            
            // Find differences
            const addedTexts = originalTexts.filter(text => !comparisonSet.has(text));
            const removedTexts = comparisonTexts.filter(text => !originalSet.has(text));
            const commonTexts = originalTexts.filter(text => comparisonSet.has(text));
            
            // Apply highlighting to rendered elements
            Array.from(renderedElements).forEach(element => {
                const elementText = element.textContent.trim();
                
                if (addedTexts.includes(elementText)) {
                    // This content was added in the new version
                    element.classList.add('diff-line-added');
                    element.title = 'Added in this version';
                    changeCount.added++;
                } else if (removedTexts.includes(elementText)) {
                    // This shouldn't happen in original content, but for completeness
                    element.classList.add('diff-line-removed'); 
                    element.title = 'Removed in this version';
                    changeCount.removed++;
                } else if (commonTexts.includes(elementText)) {
                    // Check if position changed (simple heuristic for modification)
                    const originalIndex = originalTexts.indexOf(elementText);
                    const comparisonIndex = comparisonTexts.indexOf(elementText);
                    
                    if (Math.abs(originalIndex - comparisonIndex) > 2) {
                        // Content moved significantly - mark as modified
                        element.classList.add('diff-line-modified');
                        element.title = 'Position changed in this version';
                        changeCount.modified++;
                    }
                }
            });
            
            // Count removed items (for completeness in logging)
            changeCount.removed = removedTexts.length;
            
            console.log(`Text differences: ${changeCount.added} added, ${changeCount.modified} modified, ${changeCount.removed} removed`);
        }
        
        function highlightTableDifferences(original, comparison, contentDiv) {
            console.log('Highlighting table row differences');
            contentDiv.innerHTML = original;
            
            // Parse both versions to find the differences
            const tempOriginal = document.createElement('div');
            const tempComparison = document.createElement('div');
            tempOriginal.innerHTML = original;
            tempComparison.innerHTML = comparison;
            
            const originalRows = Array.from(tempOriginal.querySelectorAll('tbody tr'));
            const comparisonRows = Array.from(tempComparison.querySelectorAll('tbody tr'));
            
            console.log(`v${documentMetadata.version} has ${originalRows.length} rows vs comparison with ${comparisonRows.length} rows - ${originalRows.length - comparisonRows.length} new rows`);
            
            // Highlight the new rows (if there are more in original than comparison)
            if (originalRows.length > comparisonRows.length) {
                const tableRows = contentDiv.querySelectorAll('tbody tr');
                const newRowsCount = originalRows.length - comparisonRows.length;
                console.log(`Highlighting ${newRowsCount} new rows (${comparisonRows.length} to ${originalRows.length - 1})`);
                
                for (let i = comparisonRows.length; i < originalRows.length; i++) {
                    if (tableRows[i]) {
                        tableRows[i].style.setProperty('background-color', '#d4edda', 'important');
                        tableRows[i].style.border = '3px solid #28a745';
                        tableRows[i].title = 'New row added in this version';
                        
                        // Apply background to all cells in the row
                        const cells = tableRows[i].querySelectorAll('td');
                        cells.forEach(cell => {
                            cell.style.setProperty('background-color', '#d4edda', 'important');
                        });
                    }
                }
            }
        }
        
        function highlightCellDifferences(originalRows, comparisonRows, contentDiv, originalHtml) {
            console.log('Highlighting cell-level differences');
            contentDiv.innerHTML = originalHtml;
            
            // Find and highlight specific cell differences
            let differencesFound = false;
            const tableRows = contentDiv.querySelectorAll('tbody tr');
            
            originalRows.forEach((originalRow, rowIndex) => {
                if (rowIndex < comparisonRows.length) {
                    const comparisonRow = comparisonRows[rowIndex];
                    const originalCells = Array.from(originalRow.querySelectorAll('td'));
                    const comparisonCells = Array.from(comparisonRow.querySelectorAll('td'));
                    
                    originalCells.forEach((originalCell, cellIndex) => {
                        if (cellIndex < comparisonCells.length) {
                            const originalText = originalCell.textContent.trim();
                            const comparisonText = comparisonCells[cellIndex].textContent.trim();
                            
                            if (originalText !== comparisonText) {
                                console.log(`Row ${rowIndex}, Cell ${cellIndex} differs`);
                                const actualCell = tableRows[rowIndex]?.querySelectorAll('td')[cellIndex];
                                if (actualCell) {
                                    actualCell.style.backgroundColor = '#fff3cd';
                                    actualCell.style.border = '2px solid #ffc107';
                                    actualCell.title = `Changed from: "${comparisonText}"`;
                                    differencesFound = true;
                                }
                            }
                        }
                    });
                }
            });
            
            if (!differencesFound) {
                const indicator = document.createElement('div');
                indicator.style.cssText = 'background: #d1ecf1; color: #0c5460; padding: 10px; margin: 10px 0; border: 1px solid #bee5eb; border-radius: 4px;';
                indicator.innerHTML = '‚ÑπÔ∏è No significant content differences found between versions';
                contentDiv.insertBefore(indicator, contentDiv.firstChild);
            }
        }
        
        function changeWidth() {
            const widthSelect = document.getElementById('widthSelect');
            const contentDiv = document.getElementById('mainContent');
            const selectedWidth = widthSelect.value;
            
            // Remove all width classes
            contentDiv.classList.remove('narrow', 'wide', 'full-width', 'standard');
            
            // Add the selected width class
            contentDiv.classList.add(selectedWidth);
            
            console.log('Width changed to:', selectedWidth);
        }
        
        // Theme Toggle Functions
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const themeButton = document.getElementById('themeToggle');
            themeButton.innerHTML = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            
            console.log('Theme changed to:', newTheme);
        }
        
        function initializeTheme() {
            // Check for saved theme preference or default to system preference
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            let theme;
            if (savedTheme) {
                theme = savedTheme;
            } else {
                theme = systemPrefersDark ? 'dark' : 'light';
            }
            
            document.documentElement.setAttribute('data-theme', theme);
            const themeButton = document.getElementById('themeToggle');
            themeButton.innerHTML = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            
            console.log('Theme initialized:', theme);
        }
        
        // Navigation Functions
        function goBack() {
            window.history.back();
        }
        
        function goToIndex() {
            window.location.href = 'index.html';
        }
        
        // Modern Navigation System with Search
        function initializeNavigation() {
            const nav = document.getElementById('sectionNav');
            const searchInput = document.getElementById('navSearch');
            const noResults = document.getElementById('navNoResults');
            const headers = document.querySelectorAll('#mainContent h1, #mainContent h2, #mainContent h3');
            
            let navigationData = [];
            let currentH1 = null;
            let currentH2 = null;
            
            // Build navigation data structure
            headers.forEach((header, index) => {
                // Create anchor ID if it doesn't exist
                if (!header.id) {
                    header.id = `section-${index}`;
                }
                
                const level = parseInt(header.tagName.charAt(1));
                const navItem = {
                    id: header.id,
                    text: header.textContent.trim(),
                    level: level,
                    element: header,
                    searchText: header.textContent.toLowerCase().trim()
                };
                
                navigationData.push(navItem);
            });
            
            // Render navigation tree
            function renderNavigation(items = navigationData) {
                nav.innerHTML = '';
                noResults.style.display = items.length === 0 ? 'block' : 'none';
                
                let currentH1Container = null;
                let currentH2Container = null;
                
                items.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = 'nav-item';
                    
                    // Create item header container
                    const headerDiv = document.createElement('div');
                    headerDiv.className = 'nav-item-header';
                    
                    if (item.level === 1) {
                        const hasChildren = items.some((child, childIndex) => 
                            childIndex > index && child.level === 2);
                        
                        if (hasChildren) {
                            const toggle = document.createElement('div');
                            toggle.className = 'nav-toggle';
                            toggle.innerHTML = '‚ñ∂';
                            toggle.onclick = (e) => {
                                e.stopPropagation();
                                toggleNavSection(toggle, li);
                            };
                            headerDiv.appendChild(toggle);
                        } else {
                            const spacer = document.createElement('div');
                            spacer.style.width = '24px';
                            headerDiv.appendChild(spacer);
                        }
                        
                        const a = document.createElement('a');
                        a.href = `#${item.id}`;
                        a.textContent = item.text;
                        a.className = `nav-link h1`;
                        a.onclick = (e) => navigateToSection(e, item.element, a);
                        headerDiv.appendChild(a);
                        
                        li.appendChild(headerDiv);
                        
                        if (hasChildren) {
                            const childrenContainer = document.createElement('div');
                            childrenContainer.className = 'nav-children';
                            li.appendChild(childrenContainer);
                            currentH2Container = childrenContainer;
                        }
                        
                        nav.appendChild(li);
                        currentH1Container = li;
                        
                    } else if (item.level === 2 && currentH2Container) {
                        const h2Li = document.createElement('li');
                        h2Li.className = 'nav-item';
                        
                        const h2Header = document.createElement('div');
                        h2Header.className = 'nav-item-header';
                        
                        const spacer = document.createElement('div');
                        spacer.style.width = '24px';
                        h2Header.appendChild(spacer);
                        
                        const a = document.createElement('a');
                        a.href = `#${item.id}`;
                        a.textContent = item.text;
                        a.className = `nav-link h2`;
                        a.onclick = (e) => navigateToSection(e, item.element, a);
                        h2Header.appendChild(a);
                        
                        h2Li.appendChild(h2Header);
                        currentH2Container.appendChild(h2Li);
                        
                    } else if (item.level === 3 && currentH2Container) {
                        const h3Li = document.createElement('li');
                        h3Li.className = 'nav-item';
                        
                        const h3Header = document.createElement('div');
                        h3Header.className = 'nav-item-header';
                        
                        const spacer = document.createElement('div');
                        spacer.style.width = '24px';
                        h3Header.appendChild(spacer);
                        
                        const a = document.createElement('a');
                        a.href = `#${item.id}`;
                        a.textContent = item.text;
                        a.className = `nav-link h3`;
                        a.onclick = (e) => navigateToSection(e, item.element, a);
                        h3Header.appendChild(a);
                        
                        h3Li.appendChild(h3Header);
                        currentH2Container.appendChild(h3Li);
                    }
                });
                
                // Auto-expand first level
                const firstExpandable = nav.querySelector('.nav-toggle');
                if (firstExpandable) {
                    const firstContainer = firstExpandable.parentElement.parentElement;
                    toggleNavSection(firstExpandable, firstContainer);
                }
            }
            
            // Search functionality
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase().trim();
                
                if (query === '') {
                    renderNavigation(navigationData);
                } else {
                    const filtered = navigationData.filter(item => 
                        item.searchText.includes(query));
                    renderNavigation(filtered);
                }
            });
            
            // Initial render
            renderNavigation();
            
            // Update active nav item on scroll
            window.addEventListener('scroll', updateActiveNavOnScroll);
            
            // Initialize minimap
            initializeMinimap();
        }
        
        function checkForChildren(headers, currentIndex, targetLevel = null) {
            const currentLevel = parseInt(headers[currentIndex].tagName.charAt(1));
            const checkLevel = targetLevel || (currentLevel + 1);
            
            for (let i = currentIndex + 1; i < headers.length; i++) {
                const nextLevel = parseInt(headers[i].tagName.charAt(1));
                if (nextLevel <= currentLevel) break;
                if (nextLevel === checkLevel) return true;
            }
            return false;
        }
        
        function toggleNavSection(toggle, container) {
            const childrenContainer = container.querySelector('.nav-children');
            if (!childrenContainer) return;
            
            const isExpanded = childrenContainer.classList.contains('expanded');
            
            if (isExpanded) {
                childrenContainer.classList.remove('expanded');
                toggle.classList.remove('expanded');
                toggle.innerHTML = '‚ñ∂';
            } else {
                childrenContainer.classList.add('expanded');
                toggle.classList.add('expanded');
                toggle.innerHTML = '‚ñº';
            }
        }
        
        // Modern Minimap Implementation
        function initializeMinimap() {
            const minimap = document.getElementById('minimap');
            const minimapViewport = document.getElementById('minimapViewport');
            const mainContent = document.getElementById('mainContent');
            
            if (!minimap || !minimapViewport || !mainContent) return;
            
            function updateMinimapViewport() {
                const docHeight = document.documentElement.scrollHeight;
                const viewHeight = window.innerHeight;
                const scrollTop = window.pageYOffset;
                const minimapHeight = minimap.clientHeight - 100; // Account for header
                
                // Calculate viewport position and size
                const viewportTop = (scrollTop / docHeight) * minimapHeight;
                const viewportHeight = Math.max(20, (viewHeight / docHeight) * minimapHeight);
                
                minimapViewport.style.top = `${viewportTop}px`;
                minimapViewport.style.height = `${viewportHeight}px`;
            }
            
            // Update on scroll and resize
            window.addEventListener('scroll', updateMinimapViewport);
            window.addEventListener('resize', updateMinimapViewport);
            
            // Click to navigate
            const minimapContent = minimap.querySelector('.minimap-content');
            minimapContent.addEventListener('click', (e) => {
                const rect = minimapContent.getBoundingClientRect();
                const clickY = e.clientY - rect.top;
                const minimapHeight = minimapContent.clientHeight;
                const scrollPercent = clickY / minimapHeight;
                const targetScroll = scrollPercent * (document.documentElement.scrollHeight - window.innerHeight);
                
                window.scrollTo({ top: Math.max(0, targetScroll), behavior: 'smooth' });
            });
            
            // Initial update
            updateMinimapViewport();
        }
        
        function navigateToSection(e, header, link) {
            e.preventDefault();
            header.scrollIntoView({ behavior: 'smooth' });
            updateActiveNavItem(link);
        }
        
        function updateActiveNavItem(activeLink) {
            document.querySelectorAll('#sectionNav a').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }
        
        function updateActiveNavOnScroll() {
            const headers = document.querySelectorAll('#mainContent h1, #mainContent h2, #mainContent h3');
            const navLinks = document.querySelectorAll('#sectionNav a');
            
            let current = '';
            headers.forEach(header => {
                const rect = header.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = header.id;
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        }
        
        // Floating Top Bar Scroll Behavior
        let lastScrollTop = 0;
        let scrollTimeout;
        
        function initializeScrollBehavior() {
            const topBar = document.getElementById('topBar');
            
            window.addEventListener('scroll', function() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Clear any existing timeout
                clearTimeout(scrollTimeout);
                
                // Hide/show logic
                if (scrollTop > lastScrollTop && scrollTop > 60) {
                    // Scrolling down & past header height
                    topBar.classList.add('hidden');
                } else {
                    // Scrolling up or at top
                    topBar.classList.remove('hidden');
                }
                
                lastScrollTop = scrollTop;
                
                // Update change indicators if visible
                updateChangeIndicators();
            }, { passive: true });
        }
        
        // Change Indicator Functions
        function updateChangeIndicators() {
            const indicator = document.getElementById('changeIndicator');
            if (!indicator.style.display || indicator.style.display === 'none') return;
            
            // Get document dimensions
            const docHeight = document.documentElement.scrollHeight;
            const viewHeight = window.innerHeight;
            const scrollTop = window.pageYOffset;
            
            // Update existing change marks
            const marks = indicator.querySelectorAll('.change-mark');
            marks.forEach(mark => {
                const targetId = mark.dataset.target;
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    const elementTop = targetElement.offsetTop;
                    const percentage = (elementTop / docHeight) * 100;
                    mark.style.top = `${percentage}%`;
                }
            });
        }
        
        function createChangeIndicators() {
            const indicator = document.getElementById('changeIndicator');
            const minimapContent = document.querySelector('.minimap-content');
            
            if (!indicator || !minimapContent) return;
            
            indicator.innerHTML = ''; // Clear existing marks
            
            // Find all changed elements
            const addedElements = document.querySelectorAll('.diff-line-added, tr[style*="background-color: #d4edda"]');
            const modifiedElements = document.querySelectorAll('.diff-line-modified, td[style*="background-color: #fff3cd"]');
            const removedElements = document.querySelectorAll('.diff-line-removed');
            
            const docHeight = document.documentElement.scrollHeight;
            const minimapHeight = minimapContent.clientHeight;
            
            // Helper function to create change marks
            function createChangeMark(element, type, index) {
                const mark = document.createElement('div');
                mark.className = `change-mark ${type}`;
                mark.dataset.target = element.id || `${type}-${index}`;
                
                if (!element.id) {
                    element.id = `${type}-${index}`;
                }
                
                const elementTop = element.offsetTop;
                const percentage = (elementTop / docHeight) * minimapHeight;
                mark.style.top = `${Math.max(0, Math.min(minimapHeight - 3, percentage))}px`;
                
                // Set titles
                const titles = {
                    added: 'Added content',
                    modified: 'Modified content', 
                    removed: 'Removed content'
                };
                mark.title = titles[type] || element.title || `${type} content`;
                
                // Click to scroll to element
                mark.addEventListener('click', (e) => {
                    e.stopPropagation();
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                });
                
                return mark;
            }
            
            // Create marks for added elements
            addedElements.forEach((element, index) => {
                const mark = createChangeMark(element, 'added', index);
                indicator.appendChild(mark);
            });
            
            // Create marks for modified elements
            modifiedElements.forEach((element, index) => {
                const mark = createChangeMark(element, 'modified', index);
                indicator.appendChild(mark);
            });
            
            // Create marks for removed elements
            removedElements.forEach((element, index) => {
                const mark = createChangeMark(element, 'removed', index);
                indicator.appendChild(mark);
            });
            
            const totalChanges = addedElements.length + modifiedElements.length + removedElements.length;
            
            // Show indicator if there are changes
            if (totalChanges > 0) {
                indicator.style.display = 'block';
                console.log(`Created ${totalChanges} change indicators (${addedElements.length} added, ${modifiedElements.length} modified, ${removedElements.length} removed)`);
            } else {
                indicator.style.display = 'none';
            }
        }
    </script>
</body>
</html>